---
title: REST API
sidebar_position: 1
---

import { CodeBlockToggle, DbTable, Highlight, FileRef, MethodRef } from "@site/src/components/convengine";

# REST API

## Base

<FileRef>/api/v1/conversation</FileRef>

## Endpoints

<DbTable
  title="Conversation endpoints"
  columns={["Method", "Path", "Purpose"]}
  rows={[
    ["POST", "/message", "Process one turn and return payload"],
    ["GET", "/audit/{conversationId}", "Raw audit rows for conversation"],
    ["GET", "/audit/{conversationId}/trace", "Normalized step+stage timeline"],
    ["GET", "/stream/{conversationId}", "SSE live stream of audit events"],
  ]}
/>

## POST <FileRef>/message</FileRef>

<CodeBlockToggle title="Request body" language="json" defaultOpen={true}>
{`{
  "conversationId": "uuid-optional",
  "message": "Track request REQ-778102",
  "reset": false,
  "inputParams": {
    "tenant": "acme"
  }
}`}
</CodeBlockToggle>

<CodeBlockToggle title="Success response" language="json" defaultOpen={true}>
{`{
  "success": true,
  "conversationId": "9bf7540a-b129-4685-a120-730e8a0cb94b",
  "intent": "REQUEST_TRACKER",
  "state": "IDLE",
  "payload": {
    "type": "TEXT",
    "value": "Request REQ-778102 is IN_REVIEW."
  },
  "context": "{...}"
}`}
</CodeBlockToggle>

## Experimental endpoint (feature-flagged)

Base: <FileRef>/api/v1/conversation/experimental</FileRef>

- <MethodRef>POST /generate-sql</MethodRef>

Enable with:

<CodeBlockToggle title="application.yml (feature flag)" language="yaml">
{`convengine:
  experimental:
    enabled: true`}
</CodeBlockToggle>

<Highlight type="warning" title="Experimental output">
Generated SQL should be reviewed before use. The endpoint applies safety checks but does not replace human review.
</Highlight>

## Runtime performance controls (no new endpoint)

<CodeBlockToggle title="application.yml (audit + transport controls)" language="yaml">
{`convengine:
  audit:
    enabled: true
    level: ALL # ALL | STANDARD | ERROR_ONLY | NONE
    include-stages: [] # wildcard supported e.g. STEP_*
    exclude-stages: []
    persistence:
      mode: IMMEDIATE # IMMEDIATE | DEFERRED_BULK
      jdbc-batch-size: 200
      max-buffered-events: 5000
      flush-stages: ENGINE_KNOWN_FAILURE,ENGINE_UNKNOWN_FAILURE
      final-step-names: PipelineEndGuardStep
      flush-on-stop-outcome: true
    dispatch:
      async-enabled: false
      worker-threads: 2
      queue-capacity: 2000
      rejection-policy: CALLER_RUNS # CALLER_RUNS | DROP_NEWEST | DROP_OLDEST | ABORT
      keep-alive-seconds: 60
    rate-limit:
      enabled: false
      max-events: 200
      window-ms: 1000
      per-conversation: true
      per-stage: true
      max-tracked-buckets: 20000

  transport:
    stomp:
      enabled: true
      broker:
        mode: SIMPLE # SIMPLE | RELAY
        relay-destination-prefixes: /topic,/queue
        relay-host: localhost
        relay-port: 61613`}
</CodeBlockToggle>
