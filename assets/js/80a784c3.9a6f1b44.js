"use strict";(globalThis.webpackChunkconvengine_docs=globalThis.webpackChunkconvengine_docs||[]).push([[641],{9647(e,n,t){t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>u,frontMatter:()=>i,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"consumer/extensions","title":"Extensions","description":"1) EngineStepHook - intervene between any steps","source":"@site/docs/consumer/extensions.mdx","sourceDirName":"consumer","slug":"/consumer/extensions","permalink":"/docs/consumer/extensions","draft":false,"unlisted":false,"editUrl":"https://github.com/salilvnair/convengine-docs/tree/main/docs/consumer/extensions.mdx","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"title":"Extensions","sidebar_position":3},"sidebar":"docSidebar","previous":{"title":"Configuration","permalink":"/docs/consumer/configuration"},"next":{"title":"Session, Reset, Continuity","permalink":"/docs/consumer/session-reset-and-continuity"}}');var o=t(4848),r=t(8453),a=t(2073);const i={title:"Extensions",sidebar_position:3},c="Extension Points and Intervention Scenarios",d={},l=[{value:"1) <code>EngineStepHook</code> - intervene between any steps",id:"1-enginestephook---intervene-between-any-steps",level:2},{value:"2) <code>ContainerDataTransformer</code> - reshape container response",id:"2-containerdatatransformer---reshape-container-response",level:2},{value:"3) <code>ResponseTransformer</code> - post-process final payload",id:"3-responsetransformer---post-process-final-payload",level:2},{value:"4) <code>ContainerDataInterceptor</code> - intercept request/response around CCF",id:"4-containerdatainterceptor---intercept-requestresponse-around-ccf",level:2},{value:"5) <code>SET_TASK</code> action - execute custom Java task from rule",id:"5-set_task-action---execute-custom-java-task-from-rule",level:2}];function p(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"extension-points-and-intervention-scenarios",children:"Extension Points and Intervention Scenarios"})}),"\n",(0,o.jsxs)(n.h2,{id:"1-enginestephook---intervene-between-any-steps",children:["1) ",(0,o.jsx)(n.code,{children:"EngineStepHook"})," - intervene between any steps"]}),"\n",(0,o.jsxs)(n.p,{children:["Real scenario: For ",(0,o.jsx)(n.code,{children:"LOG_ANALYSIS"}),", inject additional retrieval hint before schema extraction."]}),"\n",(0,o.jsx)(a.vl,{title:"EngineStepHook example",language:"java",packagePath:"com.acme.convengine.hooks",children:'@Component\npublic class LogAnalysisHintHook implements EngineStepHook {\n  @Override\n  public boolean supports(String stepName, EngineSession session) {\n      return "SchemaExtractionStep".equals(stepName)\n          && "LOG_ANALYSIS".equalsIgnoreCase(session.getIntent());\n  }\n\n  @Override\n  public void beforeStep(String stepName, EngineSession session) {\n      session.putInputParam("log_source_priority", "APM_FIRST");\n  }\n}'}),"\n",(0,o.jsx)(n.admonition,{title:"Where to use this",type:"tip",children:(0,o.jsx)(n.p,{children:"Use hooks when you need low-friction runtime intervention without forking framework steps."})}),"\n",(0,o.jsxs)(n.h2,{id:"2-containerdatatransformer---reshape-container-response",children:["2) ",(0,o.jsx)(n.code,{children:"ContainerDataTransformer"})," - reshape container response"]}),"\n",(0,o.jsx)(n.p,{children:"Real scenario: CCF returns nested payload; you flatten to schema-friendly map."}),"\n",(0,o.jsx)(a.vl,{title:"ContainerDataTransformer example",language:"java",packagePath:"com.acme.convengine.transformers",children:'@Component\n@ContainerDataTransformer(intent = "REQUEST_TRACKER", state = "IDLE")\npublic class RequestTrackerContainerTransformer implements ContainerDataTransformerHandler {\n  @Override\n  public Map<String, Object> transform(ContainerComponentResponse response,\n                                       EngineSession session,\n                                       Map<String, Object> inputParams) {\n      Map<String, Object> out = new LinkedHashMap<>();\n      out.put("ticket_id", inputParams.get("ticketId"));\n      out.put("status", "IN_REVIEW");\n      return out;\n  }\n}'}),"\n",(0,o.jsxs)(n.h2,{id:"3-responsetransformer---post-process-final-payload",children:["3) ",(0,o.jsx)(n.code,{children:"ResponseTransformer"})," - post-process final payload"]}),"\n",(0,o.jsx)(n.p,{children:"Real scenario: Add support-team escalation footer for high-severity disconnect failures."}),"\n",(0,o.jsx)(a.vl,{title:"ResponseTransformer example",language:"java",packagePath:"com.acme.convengine.transformers",children:'@Component\n@ResponseTransformer(intent = "DISCONNECT_ELECTRICITY", state = "FAILED")\npublic class DisconnectFailureResponseTransformer implements ResponseTransformerHandler {\n  @Override\n  public OutputPayload transform(OutputPayload responsePayload,\n                                 EngineSession session,\n                                 Map<String, Object> inputParams) {\n      if (responsePayload instanceof TextPayload(String text)) {\n          return new TextPayload(text + "\\nIf this is urgent, call support at +1-800-000-0000.");\n      }\n      return responsePayload;\n  }\n}'}),"\n",(0,o.jsxs)(n.h2,{id:"4-containerdatainterceptor---intercept-requestresponse-around-ccf",children:["4) ",(0,o.jsx)(n.code,{children:"ContainerDataInterceptor"})," - intercept request/response around CCF"]}),"\n",(0,o.jsx)(n.p,{children:"Real scenario: add tenant metadata and redact a field before persistence."}),"\n",(0,o.jsx)(a.vl,{title:"Interceptor scenario (concept)",language:"text",children:"Before Execute:\n- inject tenantId/requestId\n- attach observability headers\n\nAfter Execute:\n- redact sensitive node from raw container payload\n- enrich session input params for downstream rule checks"}),"\n",(0,o.jsxs)(n.h2,{id:"5-set_task-action---execute-custom-java-task-from-rule",children:["5) ",(0,o.jsx)(n.code,{children:"SET_TASK"})," action - execute custom Java task from rule"]}),"\n",(0,o.jsx)(n.p,{children:"Real scenario: If log analysis detects threshold breach, dispatch internal incident task."}),"\n",(0,o.jsx)(a.zM,{step:"1",title:"Rule row",children:(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"ce_rule.action=SET_TASK"}),", ",(0,o.jsx)(n.code,{children:"action_value=myIncidentTaskBean:raiseIncident"})]})}),"\n",(0,o.jsx)(a.zM,{step:"2",title:"Runtime",children:(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"SetTaskActionResolver"})," parses bean+method and invokes ",(0,o.jsx)(n.code,{children:"CeRuleTaskExecutor"}),"."]})}),"\n",(0,o.jsx)(a.zM,{step:"3",title:"Outcome",children:(0,o.jsx)(n.p,{children:"Task can write to session/context/inputParams and influence downstream response."})}),"\n",(0,o.jsx)(a.f4,{type:"info",title:"Rule safety",children:(0,o.jsx)(n.p,{children:"Use deterministic task methods. Avoid side effects that are not idempotent unless you include strong guards in rule conditions."})})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(p,{...e})}):p(e)}}}]);