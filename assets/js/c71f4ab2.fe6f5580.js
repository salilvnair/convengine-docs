"use strict";(globalThis.webpackChunkconvengine_docs=globalThis.webpackChunkconvengine_docs||[]).push([[4201],{1470(e,t,n){n.d(t,{A:()=>R});var i=n(6540),a=n(4164),o=n(7559),s=n(3104),r=n(6347),l=n(205),c=n(7485),u=n(1682),d=n(679);function p(e){return i.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,i.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function E(e){const{values:t,children:n}=e;return(0,i.useMemo)(()=>{const e=t??function(e){return p(e).map(({props:{value:e,label:t,attributes:n,default:i}})=>({value:e,label:t,attributes:n,default:i}))}(n);return function(e){const t=(0,u.XI)(e,(e,t)=>e.value===t.value);if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e},[t,n])}function m({value:e,tabValues:t}){return t.some(t=>t.value===e)}function I({queryString:e=!1,groupId:t}){const n=(0,r.W6)(),a=function({queryString:e=!1,groupId:t}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:e,groupId:t});return[(0,c.aZ)(a),(0,i.useCallback)(e=>{if(!a)return;const t=new URLSearchParams(n.location.search);t.set(a,e),n.replace({...n.location,search:t.toString()})},[a,n])]}function _(e){const{defaultValue:t,queryString:n=!1,groupId:a}=e,o=E(e),[s,r]=(0,i.useState)(()=>function({defaultValue:e,tabValues:t}){if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!m({value:e,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${t.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const n=t.find(e=>e.default)??t[0];if(!n)throw new Error("Unexpected error: 0 tabValues");return n.value}({defaultValue:t,tabValues:o})),[c,u]=I({queryString:n,groupId:a}),[p,_]=function({groupId:e}){const t=function(e){return e?`docusaurus.tab.${e}`:null}(e),[n,a]=(0,d.Dv)(t);return[n,(0,i.useCallback)(e=>{t&&a.set(e)},[t,a])]}({groupId:a}),h=(()=>{const e=c??p;return m({value:e,tabValues:o})?e:null})();(0,l.A)(()=>{h&&r(h)},[h]);return{selectedValue:s,selectValue:(0,i.useCallback)(e=>{if(!m({value:e,tabValues:o}))throw new Error(`Can't select invalid tab value=${e}`);r(e),u(e),_(e)},[u,_,o]),tabValues:o}}var h=n(2303);const T="tabList__CuJ",A="tabItem_LNqP";var N=n(4848);function f({className:e,block:t,selectedValue:n,selectValue:i,tabValues:o}){const r=[],{blockElementScrollPositionUntilNextRender:l}=(0,s.a_)(),c=e=>{const t=e.currentTarget,a=r.indexOf(t),s=o[a].value;s!==n&&(l(t),i(s))},u=e=>{let t=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const n=r.indexOf(e.currentTarget)+1;t=r[n]??r[0];break}case"ArrowLeft":{const n=r.indexOf(e.currentTarget)-1;t=r[n]??r[r.length-1];break}}t?.focus()};return(0,N.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,a.A)("tabs",{"tabs--block":t},e),children:o.map(({value:e,label:t,attributes:i})=>(0,N.jsx)("li",{role:"tab",tabIndex:n===e?0:-1,"aria-selected":n===e,ref:e=>{r.push(e)},onKeyDown:u,onClick:c,...i,className:(0,a.A)("tabs__item",A,i?.className,{"tabs__item--active":n===e}),children:t??e},e))})}function S({lazy:e,children:t,selectedValue:n}){const o=(Array.isArray(t)?t:[t]).filter(Boolean);if(e){const e=o.find(e=>e.props.value===n);return e?(0,i.cloneElement)(e,{className:(0,a.A)("margin-top--md",e.props.className)}):null}return(0,N.jsx)("div",{className:"margin-top--md",children:o.map((e,t)=>(0,i.cloneElement)(e,{key:t,hidden:e.props.value!==n}))})}function C(e){const t=_(e);return(0,N.jsxs)("div",{className:(0,a.A)(o.G.tabs.container,"tabs-container",T),children:[(0,N.jsx)(f,{...t,...e}),(0,N.jsx)(S,{...t,...e})]})}function R(e){const t=(0,h.A)();return(0,N.jsx)(C,{...e,children:p(e.children)},String(t))}},3916(e,t,n){n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>u,default:()=>m,frontMatter:()=>c,metadata:()=>i,toc:()=>p});const i=JSON.parse('{"id":"deep-dive/examples","title":"Real World Examples","description":"This page is intentionally dense. Each flow is shown as:","source":"@site/docs/v2/deep-dive/examples.mdx","sourceDirName":"deep-dive","slug":"/deep-dive/examples","permalink":"/docs/v2/deep-dive/examples","draft":false,"unlisted":false,"editUrl":"https://github.com/salilvnair/convengine-docs/tree/main/docs/v2/deep-dive/examples.mdx","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"title":"Real World Examples","sidebar_position":3,"hide_table_of_contents":true},"sidebar":"docSidebar","previous":{"title":"Request Lifecycle","permalink":"/docs/v2/deep-dive/lifecycle"},"next":{"title":"Data Model","permalink":"/docs/v2/deep-dive/data-model"}}');var a=n(4848),o=n(8453),s=n(1470),r=n(9365),l=n(9131);const c={title:"Real World Examples",sidebar_position:3,hide_table_of_contents:!0},u="Real World Examples",d={},p=[{value:"Example 1: FAQ (informational path)",id:"example-1-faq-informational-path",level:2},{value:"Example 2: CONNECTION_TRANSFER (multi-turn + confirmation + pending action)",id:"example-2-connection_transfer-multi-turn--confirmation--pending-action",level:2}];function E(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",...(0,o.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.header,{children:(0,a.jsx)(t.h1,{id:"real-world-examples",children:"Real World Examples"})}),"\n",(0,a.jsx)(t.p,{children:"This page is intentionally dense. Each flow is shown as:"}),"\n",(0,a.jsxs)(t.ol,{children:["\n",(0,a.jsx)(t.li,{children:"Chat transcript"}),"\n",(0,a.jsx)(t.li,{children:"Per-turn step trace (what executed and why)"}),"\n",(0,a.jsxs)(t.li,{children:["Required control-plane rows (",(0,a.jsx)(t.code,{children:"ce_*"}),")"]}),"\n",(0,a.jsx)(t.li,{children:"Audit timeline with payload-level checkpoints"}),"\n"]}),"\n",(0,a.jsx)(t.h2,{id:"example-1-faq-informational-path",children:"Example 1: FAQ (informational path)"}),"\n",(0,a.jsxs)(s.A,{groupId:"v2-faq-deep",children:[(0,a.jsxs)(r.A,{value:"chat",label:"Chat Transcript",default:!0,children:[(0,a.jsxs)(l.sy,{title:"FAQ conversation",children:[(0,a.jsx)(l.KJ,{children:"How do I transfer my electricity connection?"}),(0,a.jsx)(l.Fb,{children:"Share customerId, phone, email, source city, and target city. Then confirm to submit transfer."})]}),(0,a.jsx)(l.p,{title:"Intent and state outcome",columns:["Field","Expected value","Why"],rows:[["intent","FAQ","Classifier matches informational query language"],["state","IDLE","No slot collection / no pending action required"],["responseType","DERIVED (TEXT)","FAQ answer generated from prompt/context"]]})]}),(0,a.jsxs)(r.A,{value:"trace",label:"Per-turn Step Trace",children:[(0,a.jsx)(l.p,{title:"Turn T1 runtime trace",columns:["Order","Step","Input facts","Output facts"],rows:[["1","LoadOrCreateConversationStep","conversationId present or new","session opened/hydrated"],["2","AuditUserInputStep","raw user text","USER_INPUT audit row"],["3","DialogueActStep","question sentence","dialogue_act=QUESTION"],["4","InteractionPolicyStep","no pending_action, no pending_slot","policy_decision=RECLASSIFY_INTENT"],["5","IntentResolutionStep","classifiers + agent hints","intent=FAQ, state=IDLE"],["6","SchemaExtractionStep","FAQ schema (light)","schema facts available"],["7","RulesStep","no FAQ rule action","RULE_NO_MATCH or no mutation"],["8","ResponseResolutionStep","FAQ response row + prompt","assistant output prepared"],["9","MemoryStep","recent turn context","memory_session_summary"],["10","PersistConversationStep","final session","conversation/audit persisted"]]}),(0,a.jsx)(l.f4,{type:"info",title:"Why no pending-action path here",children:(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.code,{children:"InteractionPolicyStep"})," sees no ",(0,a.jsx)(t.code,{children:"pending_action"})," signal and does not produce ",(0,a.jsx)(t.code,{children:"EXECUTE_PENDING_ACTION"}),". The turn continues as a regular intent-resolution flow."]})})]}),(0,a.jsxs)(r.A,{value:"db",label:"Required ce_* Rows",children:[(0,a.jsx)(l.p,{title:"Minimum rows required for FAQ flow",columns:["Table","Required row shape","Used by"],rows:[["ce_intent","intent_code=FAQ","IntentResolutionStep"],["ce_intent_classifier","intent_code=FAQ, rule_type=REGEX","IntentResolutionStep"],["ce_prompt_template","intent_code=FAQ, response_type=TEXT","ResponseResolutionStep (DERIVED)"],["ce_response","intent_code=FAQ, state_code=IDLE","ResponseResolutionStep"],["ce_container_config","intent_code=FAQ (optional context source)","AddContainerDataStep"],["ce_config","AgentIntentResolver + SchemaExtractionStep prompt keys","Intent/Schema steps"]]}),(0,a.jsx)(l.vl,{title:"FAQ seed snippet",language:"sql",children:"INSERT INTO ce_intent (intent_code, description, priority, enabled)\nVALUES ('FAQ', 'Answer informational questions from FAQ knowledge base', 10, true);\n\nINSERT INTO ce_intent_classifier (intent_code, rule_type, pattern, priority, enabled)\nVALUES ('FAQ', 'REGEX', '(?i)\\b(what|how|help|faq|information|details|explain)\\b', 10, true);\n\nINSERT INTO ce_prompt_template (intent_code, state_code, response_type, system_prompt, user_prompt, temperature, enabled)\nVALUES ('FAQ', 'IDLE', 'TEXT',\n      'You are a concise FAQ assistant. Answer directly and clearly.',\n      'User question: {{user_input}}\\nFAQ context: {{container_data}}\\nReturn short helpful answer.',\n      0.10, true);\n\nINSERT INTO ce_response (intent_code, state_code, output_format, response_type, derivation_hint, priority, enabled)\nVALUES ('FAQ', 'IDLE', 'TEXT', 'DERIVED',\n      'Answer FAQ using available context and user question.', 10, true);"})]}),(0,a.jsxs)(r.A,{value:"audit",label:"Audit + Payload Postmortem",children:[(0,a.jsx)(l.p,{title:"Expected audit stages (ordered)",columns:["Order","Stage","Must contain"],rows:[["1","USER_INPUT","original user message"],["2","DIALOGUE_ACT_CLASSIFIED","dialogueAct=QUESTION"],["3","INTERACTION_POLICY_DECIDED","policyDecision=RECLASSIFY_INTENT"],["4","INTENT_RESOLVED_BY_*","intent=FAQ"],["5","RESOLVE_RESPONSE_SELECTED","responseType=DERIVED"],["6","ASSISTANT_OUTPUT","output text or json payload"],["7","MEMORY_UPDATED","summaryChars/recalled flags"]]}),(0,a.jsx)(l.vl,{title:"Audit payload checkpoint: DIALOGUE_ACT_CLASSIFIED",language:"json",children:'{\n"_meta": { "stage": "DIALOGUE_ACT_CLASSIFIED" },\n"userText": "How do I transfer my electricity connection?",\n"dialogueAct": "QUESTION",\n"dialogueActConfidence": 0.70,\n"dialogueActSource": "REGEX"\n}'}),(0,a.jsx)(l.vl,{title:"Audit payload checkpoint: INTERACTION_POLICY_DECIDED",language:"json",children:'{\n"_meta": { "stage": "INTERACTION_POLICY_DECIDED" },\n"dialogueAct": "QUESTION",\n"policyDecision": "RECLASSIFY_INTENT",\n"skipIntentResolution": false,\n"hasPendingAction": false,\n"hasPendingSlot": false\n}'})]})]}),"\n",(0,a.jsx)(t.h2,{id:"example-2-connection_transfer-multi-turn--confirmation--pending-action",children:"Example 2: CONNECTION_TRANSFER (multi-turn + confirmation + pending action)"}),"\n",(0,a.jsxs)(s.A,{groupId:"v2-transfer-deep",children:[(0,a.jsx)(r.A,{value:"chat",label:"Chat Transcript",default:!0,children:(0,a.jsxs)(l.sy,{title:"Connection transfer conversation",children:[(0,a.jsx)(l.KJ,{children:"Move my electricity connection from City1 to City2."}),(0,a.jsx)(l.Fb,{children:"Please provide customerId, phone, email, sourceCity, and targetCity."}),(0,a.jsxs)(l.KJ,{children:["customerId 9912, phone 9988776655, email ",(0,a.jsx)(t.a,{href:"mailto:user@zapper.com",children:"user@zapper.com"}),", sourceCity City1, targetCity City2"]}),(0,a.jsx)(l.Fb,{children:"Do you want to move this connection right away?"}),(0,a.jsx)(l.KJ,{children:"yes please"}),(0,a.jsx)(l.Fb,{children:"Connection transfer request submitted successfully."})]})}),(0,a.jsxs)(r.A,{value:"trace",label:"Per-turn Step Trace",children:[(0,a.jsx)(l.p,{title:"Turn T1 (initial request)",columns:["Step","Key output","Notes"],rows:[["IntentResolutionStep","intent=CONNECTION_TRANSFER","Classifier picks transfer intent"],["SchemaExtractionStep","missing fields computed","Required slots are incomplete"],["RulesStep","state -> COLLECT_INPUTS","Bootstrap collection state"],["ResponseResolutionStep","ask for required fields","Prompt user for missing slots"]]}),(0,a.jsx)(l.p,{title:"Turn T2 (slot fill)",columns:["Step","Key output","Notes"],rows:[["SchemaExtractionStep","customerId/phone/email/sourceCity/targetCity extracted","Schema complete"],["RulesStep","COLLECT_INPUTS -> AWAITING_CONFIRMATION","User must confirm execution"],["ResponseResolutionStep","confirmation prompt",""]]}),(0,a.jsx)(l.p,{title:"Turn T3 (affirm)",columns:["Order","Step","Key output","Why it matters"],rows:[["1","DialogueActStep","AFFIRM","Converts 'yes please' into execution signal"],["2","InteractionPolicyStep","EXECUTE_PENDING_ACTION","Policy routes to pending action"],["3","ActionLifecycleStep","OPEN -> IN_PROGRESS","Runtime status tracked in context"],["4","DisambiguationStep","not required","Single eligible action"],["5","GuardrailStep","ALLOW","No sensitive/approval block"],["6","PendingActionStep","EXECUTED","Task bean/method invoked from ce_pending_action"],["7","RulesStep","AWAITING_CONFIRMATION -> COMPLETED","Final state transition"],["8","ResponseResolutionStep","success response","User receives completion"]]})]}),(0,a.jsxs)(r.A,{value:"db",label:"Required ce_* Rows",children:[(0,a.jsx)(l.p,{title:"Control-plane requirements",columns:["Table","Must have","Consumed by"],rows:[["ce_intent","CONNECTION_TRANSFER","IntentResolutionStep"],["ce_intent_classifier","transfer/move regex","IntentResolutionStep"],["ce_output_schema","required slots for transfer","SchemaExtractionStep"],["ce_rule","state bootstrap + completeness + completion rules","RulesStep"],["ce_pending_action","action_key + bean_name + method_names","ActionLifecycleStep/PendingActionStep"],["ce_response","COLLECT_INPUTS, AWAITING_CONFIRMATION, COMPLETED responses","ResponseResolutionStep"],["ce_config","dialogue/prompt keys","DialogueActStep/Schema steps"],["ce_policy","optional policy blocks","PolicyEnforcementStep"]]}),(0,a.jsx)(l.vl,{title:"Seed snippet: pending action + rules",language:"sql",children:"INSERT INTO ce_pending_action\n(intent_code, state_code, action_key, bean_name, method_names, priority, enabled, description)\nVALUES\n('CONNECTION_TRANSFER', 'AWAITING_CONFIRMATION', 'FINALIZE_CONNECTION_TRANSFER',\n'faqRuleTask', 'injectContainerData', 1, true,\n'Demo finalize action for connection transfer');\n\nINSERT INTO ce_rule (phase, intent_code, state_code, rule_type, match_pattern, \"action\", action_value, priority, enabled)\nVALUES\n('PIPELINE_RULES', 'CONNECTION_TRANSFER', 'IDLE', 'REGEX', '.*', 'SET_STATE', 'COLLECT_INPUTS', 10, true),\n('PIPELINE_RULES', 'CONNECTION_TRANSFER', 'COLLECT_INPUTS', 'JSON_PATH',\n'$[?(@.state == ''COLLECT_INPUTS'' && @.customerId && @.phone && @.email && @.sourceCity && @.targetCity)]',\n'SET_STATE', 'AWAITING_CONFIRMATION', 100, true),\n('PIPELINE_RULES', 'CONNECTION_TRANSFER', 'AWAITING_CONFIRMATION', 'JSON_PATH',\n'$[?(@.state == ''AWAITING_CONFIRMATION'' && (@.pending_action_result == ''EXECUTED'' || @.inputParams.pending_action_result == ''EXECUTED''))]',\n'SET_STATE', 'COMPLETED', 200, true);"})]}),(0,a.jsxs)(r.A,{value:"audit",label:"Audit + Payload Postmortem",children:[(0,a.jsx)(l.p,{title:"Confirmation turn audit chain (must appear in order)",columns:["Order","Stage","Payload keys to verify"],rows:[["1","DIALOGUE_ACT_CLASSIFIED","dialogueAct=AFFIRM, confidence, source"],["2","INTERACTION_POLICY_DECIDED","policyDecision=EXECUTE_PENDING_ACTION"],["3","PENDING_ACTION_LIFECYCLE","status=IN_PROGRESS"],["4","GUARDRAIL_ALLOW","result=ALLOW"],["5","PENDING_ACTION_EXECUTED","pendingActionResult=EXECUTED"],["6","RULE_APPLIED","state transition to COMPLETED"],["7","ASSISTANT_OUTPUT","final completion response"],["8","MEMORY_UPDATED","summary updated"]]}),(0,a.jsx)(l.vl,{title:"Audit payload checkpoint: PENDING_ACTION_EXECUTED",language:"json",children:'{\n"_meta": { "stage": "PENDING_ACTION_EXECUTED" },\n"policyDecision": "EXECUTE_PENDING_ACTION",\n"pendingActionRef": "faqRuleTask:injectContainerData",\n"pendingActionResult": "EXECUTED",\n"intent": "CONNECTION_TRANSFER",\n"state": "AWAITING_CONFIRMATION"\n}'}),(0,a.jsx)(l.vl,{title:"Audit payload checkpoint: RULE_APPLIED after execution",language:"json",children:'{\n"_meta": { "stage": "RULE_APPLIED" },\n"rulePhase": "PIPELINE_RULES",\n"intent": "CONNECTION_TRANSFER",\n"ruleStateCode": "AWAITING_CONFIRMATION",\n"action": "SET_STATE",\n"actionValue": "COMPLETED"\n}'}),(0,a.jsxs)(l.f4,{type:"success",title:"Fast failure triage",children:[(0,a.jsx)(t.p,{children:'If user says "yes" but flow loops back to confirmation, check in order:'}),(0,a.jsxs)(t.ol,{children:["\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"DIALOGUE_ACT_CLASSIFIED"})," must be ",(0,a.jsx)(t.code,{children:"AFFIRM"})]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"INTERACTION_POLICY_DECIDED"})," must be ",(0,a.jsx)(t.code,{children:"EXECUTE_PENDING_ACTION"})]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"PENDING_ACTION_EXECUTED"})," must exist"]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"RULE_APPLIED"})," must transition state from ",(0,a.jsx)(t.code,{children:"AWAITING_CONFIRMATION"})," to terminal state."]}),"\n"]})]})]})]})]})}function m(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(E,{...e})}):E(e)}},9365(e,t,n){n.d(t,{A:()=>s});n(6540);var i=n(4164);const a="tabItem_Ymn6";var o=n(4848);function s({children:e,hidden:t,className:n}){return(0,o.jsx)("div",{role:"tabpanel",className:(0,i.A)(a,n),hidden:t,children:e})}}}]);