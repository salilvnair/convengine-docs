"use strict";(globalThis.webpackChunkconvengine_docs=globalThis.webpackChunkconvengine_docs||[]).push([[7065],{8049(e,n,t){t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>p,frontMatter:()=>a,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"consumer/configuration","title":"Configuration","description":"This guide covers the core tunable properties available for ConvEngine consumers. Properties are managed via Spring Boot @ConfigurationProperties and can be set in your application.yml or application.properties.","source":"@site/docs/v2/consumer/configuration.mdx","sourceDirName":"consumer","slug":"/consumer/configuration","permalink":"/docs/v2/consumer/configuration","draft":false,"unlisted":false,"editUrl":"https://github.com/salilvnair/convengine-docs/tree/main/docs/v2/consumer/configuration.mdx","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"title":"Configuration","sidebar_position":5},"sidebar":"docSidebar","previous":{"title":"Caching & Persistence","permalink":"/docs/v2/consumer/caching-and-persistence"},"next":{"title":"Annotations Reference","permalink":"/docs/v2/consumer/annotations-reference"}}');var r=t(4848),o=t(8453),s=t(7555);const a={title:"Configuration",sidebar_position:5},l="Consumer Configuration",c={},d=[{value:"Core namespaces",id:"core-namespaces",level:2},{value:"Complete <code>application.yml</code> Reference",id:"complete-applicationyml-reference",level:2},{value:"Breakdown: Flow Configuration",id:"breakdown-flow-configuration",level:2},{value:"Breakdown: Audit Configuration",id:"breakdown-audit-configuration",level:2},{value:"Breakdown: Transport Configuration",id:"breakdown-transport-configuration",level:2},{value:"CE Verbose Runtime Messaging (v2.0.8)",id:"ce-verbose-runtime-messaging-v208",level:2},{value:"What <code>ce_verbose</code> controls",id:"what-ce_verbose-controls",level:3},{value:"CE IDE SQL panel workflow (DDL + DML)",id:"ce-ide-sql-panel-workflow-ddl--dml",level:3},{value:"Runtime usage path",id:"runtime-usage-path",level:3},{value:"Important compatibility notes",id:"important-compatibility-notes",level:3}];function u(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"consumer-configuration",children:"Consumer Configuration"})}),"\n",(0,r.jsxs)(n.p,{children:["This guide covers the core tunable properties available for ConvEngine consumers. Properties are managed via Spring Boot ",(0,r.jsx)(n.code,{children:"@ConfigurationProperties"})," and can be set in your ",(0,r.jsx)(n.code,{children:"application.yml"})," or ",(0,r.jsx)(n.code,{children:"application.properties"}),"."]}),"\n",(0,r.jsx)(n.h2,{id:"core-namespaces",children:"Core namespaces"}),"\n",(0,r.jsx)(n.p,{children:"ConvEngine introduces several configuration namespaces:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"convengine.flow.*"})," (runtime behavior tuning)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"convengine.audit.*"})," (event and tracking controls)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"convengine.transport.*"})," (SSE/STOMP delivery settings)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"convengine.tables.*"})," (dynamic table mapping overrides)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"convengine.experimental.*"})," (forward-looking toggles)"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.h2,{id:"complete-applicationyml-reference",children:["Complete ",(0,r.jsx)(n.code,{children:"application.yml"})," Reference"]}),"\n",(0,r.jsx)(n.p,{children:"Below is a complete reference of the default configuration options exposed by ConvEngine."}),"\n",(0,r.jsx)(s.vl,{title:"Complete application.yml reference",language:"yaml",defaultOpen:!0,children:'convengine:\n  # Dynamic table mapping for CE_* entities (same as V1)\n  tables:\n    AUDIT: CE_AUDIT\n    CONFIG: CE_CONFIG\n    CONTAINER_CONFIG: CE_CONTAINER_CONFIG\n    CONVERSATION: CE_CONVERSATION\n    INTENT: CE_INTENT\n    INTENT_CLASSIFIER: CE_INTENT_CLASSIFIER\n    LLM_CALL_LOG: CE_LLM_CALL_LOG\n    MCP_DB_TOOL: CE_MCP_DB_TOOL\n    MCP_PLANNER: CE_MCP_PLANNER\n    MCP_TOOL: CE_MCP_TOOL\n    OUTPUT_SCHEMA: CE_OUTPUT_SCHEMA\n    POLICY: CE_POLICY\n    PROMPT_TEMPLATE: CE_PROMPT_TEMPLATE\n    RESPONSE: CE_RESPONSE\n    RULE: CE_RULE\n\n\n  # Feature flags for experimental features\n  experimental:\n    enabled: false\n\n  # Flow tuning\n  flow:\n    query-rewrite:\n      enabled: true\n    conversation-history:\n      max-turns: 10\n    dialogue-act:\n      resolute: REGEX_THEN_LLM # REGEX_ONLY | REGEX_THEN_LLM | LLM_ONLY\n      llm-threshold: 0.90\n    interaction-policy:\n      execute-pending-on-affirm: true\n      reject-pending-on-negate: true\n      fill-pending-slot-on-non-new-request: true\n      require-resolved-intent-and-state: true\n      matrix:\n        "PENDING_ACTION:AFFIRM": EXECUTE_PENDING_ACTION\n        "PENDING_ACTION:NEGATE": REJECT_PENDING_ACTION\n        "PENDING_SLOT:EDIT": FILL_PENDING_SLOT\n        "PENDING_SLOT:QUESTION": FILL_PENDING_SLOT\n        "PENDING_SLOT:NEGATE": FILL_PENDING_SLOT\n        "PENDING_SLOT:AFFIRM": FILL_PENDING_SLOT\n    action-lifecycle:\n      enabled: true\n      ttl-turns: 3\n      ttl-minutes: 30\n    tool-orchestration:\n      enabled: true\n    guardrail:\n      enabled: true\n      sanitize-input: true\n      require-approval-for-sensitive-actions: false\n      approval-gate-fail-closed: false\n      sensitive-patterns: []\n    state-graph:\n      enabled: true\n      soft-block-on-violation: false\n      allowed-transitions: {}\n    disambiguation:\n      enabled: true\n      max-options: 5\n    memory:\n      enabled: true\n      summary-max-chars: 1200\n      recent-turns-for-summary: 3\n\n  # Transport mechanisms\n  transport:\n    sse:\n      enabled: true\n      emitter-timeout-ms: 1800000\n    stomp:\n      enabled: false\n      endpoint: /ws-convengine\n      app-destination-prefix: /app\n      topic-prefix: /topic\n      audit-destination-base: /topic/convengine/audit\n      allowed-origin-pattern: "*"\n      sock-js: true\n      broker:\n        mode: SIMPLE   # SIMPLE | RELAY\n        relay-destination-prefixes: /topic,/queue\n        relay-host: localhost\n        relay-port: 61613\n        client-login: ""\n        client-passcode: ""\n        system-login: ""\n        system-passcode: ""\n        virtual-host: ""\n        system-heartbeat-send-interval-ms: 10000\n        system-heartbeat-receive-interval-ms: 10000\n\n  # Auditing controls\n  audit:\n    enabled: true\n    persist-meta: true\n    cache-inspector: false\n    level: ALL          # ALL | STANDARD | ERROR_ONLY | NONE\n    include-stages: []\n    exclude-stages: []\n    persistence:\n      mode: IMMEDIATE   # IMMEDIATE | DEFERRED_BULK\n      jdbc-batch-size: 200\n      max-buffered-events: 5000\n      flush-stages: ENGINE_KNOWN_FAILURE,ENGINE_UNKNOWN_FAILURE\n      final-step-names: PipelineEndGuardStep\n      flush-on-stop-outcome: true\n    dispatch:\n      async-enabled: false\n      worker-threads: 2\n      queue-capacity: 2000\n      rejection-policy: CALLER_RUNS  # CALLER_RUNS | DROP_NEWEST | DROP_OLDEST | ABORT\n      keep-alive-seconds: 60\n    rate-limit:\n      enabled: false\n      max-events: 200\n      window-ms: 1000\n      per-conversation: true\n      per-stage: true\n      max-tracked-buckets: 20000'}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"breakdown-flow-configuration",children:"Breakdown: Flow Configuration"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"convengine.flow.*"})," properties control the nuanced routing behavior without requiring consumer-side hardcoded Java branching for common dialogue/action patterns."]}),"\n",(0,r.jsx)(s.p,{title:"convengine.flow.dialogue-act",columns:["Property","Default","Description"],rows:[["resolute","REGEX_THEN_LLM","Intent resolution strategy (REGEX_ONLY, REGEX_THEN_LLM, LLM_ONLY)"],["llm-threshold","0.90","Confidence threshold for LLM intent classification via DialogueAct"]]}),"\n",(0,r.jsx)(s.p,{title:"convengine.flow.query-rewrite",columns:["Property","Default","Description"],rows:[["enabled","true","Automatically derives a standalone query from conversation history for contextual downstream RAG tool injection."]]}),"\n",(0,r.jsx)(s.p,{title:"convengine.flow.conversation-history",columns:["Property","Default","Description"],rows:[["maxTurns","10","Maximum number of conversation turns to retain in history before summarization."]]}),"\n",(0,r.jsx)(s.p,{title:"convengine.flow.interaction-policy",columns:["Property","Default","Description"],rows:[["execute-pending-on-affirm","true","Automatically run pending action if user says yes"],["reject-pending-on-negate","true","Cancel pending action if user says no"],["fill-pending-slot-on-non-new-request","true","Assign input to a waiting required parameter slot"],["require-resolved-intent-and-state","true","Enforce strict intent tracking"],["matrix","{...}","Configures the fallback resolution engine for dialogue act intent mapping to standard actions (e.g. PENDING_ACTION:AFFIRM -> EXECUTE_PENDING_ACTION)"]]}),"\n",(0,r.jsx)(s.p,{title:"convengine.flow.action-lifecycle",columns:["Property","Default","Description"],rows:[["enabled","true","Tracks how long pending actions remain valid"],["ttl-turns","3","Number of conversational turns a pending action survives before eviction"],["ttl-minutes","30","Wall-clock time bounds for pending action survival"]]}),"\n",(0,r.jsx)(s.p,{title:"convengine.flow.guardrail",columns:["Property","Default","Description"],rows:[["enabled","true","General guardrail functionality"],["sanitize-input","true","Basic textual sanitization"],["require-approval-for-sensitive-actions","false","If true, high-privilege tool execution demands explicit user affirmation"],["approval-gate-fail-closed","false","If true, guardrail rejections fail closed rather than degrading gracefully"],["sensitive-patterns","[]","Regex signatures for proactive redaction"]]}),"\n",(0,r.jsx)(s.p,{title:"convengine.flow.state-graph",columns:["Property","Default","Description"],rows:[["enabled","true","Turn state transition validation on/off"],["soft-block-on-violation","false","Allow transition but mark warning if violating strict pathing"],["allowed-transitions","{}","Map defining hard-coded allowed path trajectories"]]}),"\n",(0,r.jsx)(s.p,{title:"convengine.flow.disambiguation",columns:["Property","Default","Description"],rows:[["enabled","true","Allow engine to propose follow-ups when intent density intersects/collides"],["max-options","5","Clamp the number of disambiguation choices returned"]]}),"\n",(0,r.jsx)(s.p,{title:"convengine.flow.memory",columns:["Property","Default","Description"],rows:[["enabled","true","Enables LLM-driven session summarization for long dialogues"],["summary-max-chars","1200","Maximum characters allowed in token context injection for memory"],["recent-turns-for-summary","3","Sliding window of interaction chunks prior to memory compression"]]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"breakdown-audit-configuration",children:"Breakdown: Audit Configuration"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"convengine.audit.*"})," dictates how the system records telemetry and metric payloads down to the individual pipeline stage logic."]}),"\n",(0,r.jsx)(s.p,{title:"convengine.audit",columns:["Property","Default","Description"],rows:[["enabled","true","Root toggle for the audit framework"],["persist-meta","true","Attach engine metadata to the payload (intent, state, emittedAt)"],["cache-inspector","false","Takes full snapshots of the memory session tree on every cache step"],["level","ALL","Logging verbosity threshold (ALL, STANDARD, ERROR_ONLY, NONE)"],["include-stages","[]","Whitelist specific stages"],["exclude-stages","[]","Blacklist specific stages"]]}),"\n",(0,r.jsx)(s.p,{title:"convengine.audit.dispatch",columns:["Property","Default","Description"],rows:[["async-enabled","false","Moves transport fan-out off the main request thread when true"],["worker-threads","2","Number of async audit dispatcher threads"],["queue-capacity","2000","Maximum queued events"],["rejection-policy","CALLER_RUNS","Backpressure handling when capacity exceeded (CALLER_RUNS, DROP_NEWEST, DROP_OLDEST, ABORT)"],["keep-alive-seconds","60","Metrics keep-alive window"]]}),"\n",(0,r.jsx)(s.p,{title:"convengine.audit.persistence",columns:["Property","Default","Description"],rows:[["mode","IMMEDIATE","Write style. IMMEDIATE writes row by row. DEFERRED_BULK buffers events and writes batch inserts (safer under load)."],["jdbc-batch-size","200","Row chunking factor for DB connection drivers"],["max-buffered-events","5000","Maximum heap objects maintained for bulk emission"],["flush-stages","ENGINE_KNOWN_FAILURE, ENGINE_UNKNOWN_FAILURE","Immediate force-flush triggers"],["final-step-names","PipelineEndGuardStep","Trigger to signify request termination to commit remainder logs"],["flush-on-stop-outcome","true","Flush early if a stage explicitly terminates the pipeline"]]}),"\n",(0,r.jsx)(s.p,{title:"convengine.audit.rate-limit",columns:["Property","Default","Description"],rows:[["enabled","false","Protects DB from noisy event generation loop conditions"],["max-events","200","Cap on volume"],["window-ms","1000","Time interval (sliding)"],["per-conversation","true","Bucket per conversation UUID"],["per-stage","true","Bucket per discrete execution component logic"],["max-tracked-buckets","20000","Upper memory footprint limit for Token Bucket store"]]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"breakdown-transport-configuration",children:"Breakdown: Transport Configuration"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"convengine.transport.*"})," applies to interactive async communication paths like Server Sent Events (SSE) or WebSockets via STOMP."]}),"\n",(0,r.jsx)(s.p,{title:"convengine.transport.stomp.broker",columns:["Property","Default","Description"],rows:[["mode","SIMPLE","SIMPLE operates an in-memory broker. RELAY interfaces with external STOMP brokers (e.g., RabbitMQ)."],["relay-destination-prefixes","/topic, /queue","Path segments bound to external relay dispatch"],["relay-host","localhost","Address of standard STOMP capable broker"],["relay-port","61613","Network port"],["system-heartbeat-send-interval-ms","10000","Broker heartbeat outgoing frequency"],["system-heartbeat-receive-interval-ms","10000","Broker heartbeat tolerance incoming frequency"]]}),"\n",(0,r.jsx)(s.f4,{type:"tip",title:"Stream enablement note",children:(0,r.jsxs)(n.p,{children:["Some transport handlers may also be gated by ",(0,r.jsx)(n.code,{children:"@EnableConvEngine(stream = true)"})," in your main application class."]})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"ce-verbose-runtime-messaging-v208",children:"CE Verbose Runtime Messaging (v2.0.8)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"2.0.8"})," adds a new control-plane table, ",(0,r.jsx)(n.code,{children:"ce_verbose"}),", to drive deterministic runtime progress/error messages from the Java framework pipeline."]}),"\n",(0,r.jsx)(n.p,{children:"This is not a UI-only feature. The framework resolves verbose messages in backend runtime and emits them through SSE/STOMP payloads."}),"\n",(0,r.jsxs)(n.h3,{id:"what-ce_verbose-controls",children:["What ",(0,r.jsx)(n.code,{children:"ce_verbose"})," controls"]}),"\n",(0,r.jsx)(s.p,{title:"ce_verbose matching inputs",columns:["Column","Meaning","Typical values"],rows:[["intent_code","Intent scope filter","Exact intent or `ANY`"],["state_code","State scope filter","Exact state or `ANY`"],["step_match","Step matching mode","`EXACT`, `REGEX`, `JSON_PATH`"],["step_value","Step target expression","`RulesStep`, `McpToolStep`, `.*Step$`, or JSONPath expression"],["determinant","Runtime event determinant","`STEP_ENTER`, `RULE_APPLIED`, `MCP_TOOL_CALL`, `AGENT_INTENT_ACCEPTED`, etc."],["rule_id","Optional strict rule match","Specific `ce_rule.rule_id`"],["tool_code","Optional strict tool match","Specific `ce_mcp_tool.tool_code`"],["message / error_message","Info/error text emitted to stream","Human-readable progress text"],["priority","Tie-break order (lower is stronger)","10, 20, 100"],["enabled","Row active flag","true/false"]]}),"\n",(0,r.jsx)(n.h3,{id:"ce-ide-sql-panel-workflow-ddl--dml",children:"CE IDE SQL panel workflow (DDL + DML)"}),"\n",(0,r.jsx)(n.p,{children:"If your team uses CE IDE SQL panel tabs:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Open SQL panel ",(0,r.jsx)(n.code,{children:"DDL"})," tab."]}),"\n",(0,r.jsxs)(n.li,{children:["Run ",(0,r.jsx)(n.code,{children:"src/main/resources/sql/verbose_ddl.sql"})," (or the equivalent block from your dialect ",(0,r.jsx)(n.code,{children:"ddl*.sql"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:["Open SQL panel ",(0,r.jsx)(n.code,{children:"DML"})," tab."]}),"\n",(0,r.jsxs)(n.li,{children:["Run ",(0,r.jsx)(n.code,{children:"src/main/resources/sql/verbose_seed.sql"})," (or the corresponding ",(0,r.jsx)(n.code,{children:"seed*.sql"})," rows for your dialect)."]}),"\n",(0,r.jsxs)(n.li,{children:["Refresh cache (",(0,r.jsx)(n.code,{children:"POST /api/v1/cache/refresh"}),") so ",(0,r.jsx)(n.code,{children:"ce_verbose"})," rows are loaded immediately."]}),"\n"]}),"\n",(0,r.jsx)(s.vl,{title:"Postgres standalone DDL (ce_verbose)",language:"sql",children:"CREATE TABLE ce_verbose (\n  verbose_id bigserial PRIMARY KEY,\n  intent_code text NOT NULL,\n  state_code text NOT NULL,\n  step_match text NOT NULL DEFAULT 'EXACT',\n  step_value text NOT NULL,\n  determinant text NOT NULL,\n  rule_id int8 NULL,\n  tool_code text NULL,\n  message text NULL,\n  error_message text NULL,\n  priority int4 NOT NULL DEFAULT 100,\n  enabled bool NOT NULL DEFAULT true,\n  created_at timestamptz NOT NULL DEFAULT now()\n);"}),"\n",(0,r.jsx)(s.vl,{title:"Sample DML rows (ce_verbose)",language:"sql",children:"INSERT INTO ce_verbose\n(intent_code, state_code, step_match, step_value, determinant, tool_code, message, error_message, priority, enabled)\nVALUES\n('ANY','ANY','REGEX','.*Step$','STEP_ENTER',NULL,'Agent is processing your request.','Failed while starting step execution.',100,true),\n('ANY','ANY','EXACT','RulesStep','RULE_MATCH',NULL,'Applying matching rule...','Rule evaluation failed.',20,true),\n('ANY','ANY','EXACT','McpToolStep','MCP_TOOL_CALL','loan.credit.rating.check','Checking credit rating from credit union.','Unable to fetch credit rating at the moment.',10,true);"}),"\n",(0,r.jsx)(n.h3,{id:"runtime-usage-path",children:"Runtime usage path"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"EnginePipelineFactory"})," writes step enter/exit/error telemetry into ",(0,r.jsx)(n.code,{children:"session.stepInfos"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"VerboseMessagePublisher"})," builds a resolve request (",(0,r.jsx)(n.code,{children:"intent"}),", ",(0,r.jsx)(n.code,{children:"state"}),", ",(0,r.jsx)(n.code,{children:"step"}),", ",(0,r.jsx)(n.code,{children:"determinant"}),", ",(0,r.jsx)(n.code,{children:"ruleId"}),", ",(0,r.jsx)(n.code,{children:"toolCode"}),", metadata)."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"DbVerboseMessageResolver"})," picks the highest-priority eligible row from ",(0,r.jsx)(n.code,{children:"ce_verbose"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Stream transport (",(0,r.jsx)(n.code,{children:"SSE"})," / ",(0,r.jsx)(n.code,{children:"STOMP"}),") emits event envelope with ",(0,r.jsx)(n.code,{children:'eventType="VERBOSE"'})," and ",(0,r.jsx)(n.code,{children:"verbose"})," payload."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"important-compatibility-notes",children:"Important compatibility notes"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Keep ",(0,r.jsx)(n.code,{children:"step_match"})," limited to ",(0,r.jsx)(n.code,{children:"EXACT|REGEX|JSON_PATH"}),"; startup validation rejects invalid values."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"ce_verbose"})," is part of static cache preload in ",(0,r.jsx)(n.code,{children:"2.0.8"}),"; missing table/invalid rows can fail startup."]}),"\n",(0,r.jsx)(n.li,{children:"Keep verbose text operational and short; this payload can be streamed to end-user channels."}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(u,{...e})}):u(e)}}}]);