"use strict";(globalThis.webpackChunkconvengine_docs=globalThis.webpackChunkconvengine_docs||[]).push([[9993],{3650(e,s,n){n.r(s),n.d(s,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>d,metadata:()=>i,toc:()=>t});const i=JSON.parse('{"id":"deep-dive/rules-responses","title":"Rules & Responses","description":"Rule phases","source":"@site/docs/v2/deep-dive/rules-responses.mdx","sourceDirName":"deep-dive","slug":"/deep-dive/rules-responses","permalink":"/docs/v2/deep-dive/rules-responses","draft":false,"unlisted":false,"editUrl":"https://github.com/salilvnair/convengine-docs/tree/main/docs/v2/deep-dive/rules-responses.mdx","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"title":"Rules & Responses","sidebar_position":6},"sidebar":"docSidebar","previous":{"title":"Intent & Schema","permalink":"/docs/v2/deep-dive/intent-and-schema"},"next":{"title":"MCP and Audit","permalink":"/docs/v2/deep-dive/mcp-audit"}}');var l=n(4848),r=n(8453);const d={title:"Rules & Responses",sidebar_position:6},o="Rules and Response Resolution",c={},t=[{value:"Rule phases",id:"rule-phases",level:2},{value:"Rule matching behavior",id:"rule-matching-behavior",level:2},{value:"Response resolution behavior",id:"response-resolution-behavior",level:2},{value:"Operational guidance",id:"operational-guidance",level:2}];function a(e){const s={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",ul:"ul",...(0,r.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(s.header,{children:(0,l.jsx)(s.h1,{id:"rules-and-response-resolution",children:"Rules and Response Resolution"})}),"\n",(0,l.jsx)(s.h2,{id:"rule-phases",children:"Rule phases"}),"\n",(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.code,{children:"ce_rule.phase"})," supports:"]}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsx)(s.li,{children:(0,l.jsx)(s.code,{children:"PRE_EVAL"})}),"\n",(0,l.jsx)(s.li,{children:(0,l.jsx)(s.code,{children:"EVAL"})}),"\n",(0,l.jsx)(s.li,{children:(0,l.jsx)(s.code,{children:"POST_EVAL"})}),"\n",(0,l.jsx)(s.li,{children:(0,l.jsx)(s.code,{children:"AGENT_POST_INTENT"})}),"\n",(0,l.jsx)(s.li,{children:(0,l.jsx)(s.code,{children:"MCP_POST_LLM"})}),"\n",(0,l.jsx)(s.li,{children:(0,l.jsx)(s.code,{children:"TOOL_POST_EXECUTION"})}),"\n"]}),"\n",(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.code,{children:"RulesStep"})," now writes phase/source/origin metadata into input params and audit payload for every pass."]}),"\n",(0,l.jsx)(s.h2,{id:"rule-matching-behavior",children:"Rule matching behavior"}),"\n",(0,l.jsx)(s.p,{children:"For each pass:"}),"\n",(0,l.jsxs)(s.ol,{children:["\n",(0,l.jsx)(s.li,{children:"fetch by phase + session state"}),"\n",(0,l.jsxs)(s.li,{children:["check intent (",(0,l.jsx)(s.code,{children:"ANY"}),"/blank/null supported)"]}),"\n",(0,l.jsxs)(s.li,{children:["check state (",(0,l.jsx)(s.code,{children:"ANY"}),"/blank/null supported)"]}),"\n",(0,l.jsxs)(s.li,{children:["evaluate type resolver (",(0,l.jsx)(s.code,{children:"EXACT"}),", ",(0,l.jsx)(s.code,{children:"REGEX"}),", ",(0,l.jsx)(s.code,{children:"JSON_PATH"}),")"]}),"\n",(0,l.jsx)(s.li,{children:"execute action resolver"}),"\n",(0,l.jsx)(s.li,{children:"rerun pass if intent/state changed (max pass cap)"}),"\n"]}),"\n",(0,l.jsxs)(s.p,{children:["Audit emitted even when not matched (",(0,l.jsx)(s.code,{children:"RULE_NO_MATCH"}),") with explicit reason."]}),"\n",(0,l.jsx)(s.h2,{id:"response-resolution-behavior",children:"Response resolution behavior"}),"\n",(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.code,{children:"ResponseResolutionStep"}),":"]}),"\n",(0,l.jsxs)(s.ol,{children:["\n",(0,l.jsx)(s.li,{children:"selects response template by intent/state/priority"}),"\n",(0,l.jsx)(s.li,{children:"resolves output format"}),"\n",(0,l.jsxs)(s.li,{children:["emits ",(0,l.jsx)(s.code,{children:"RESOLVE_RESPONSE*"})," audit stages"]}),"\n",(0,l.jsxs)(s.li,{children:["writes final payload (",(0,l.jsx)(s.code,{children:"EXACT"})," or ",(0,l.jsx)(s.code,{children:"DERIVED"}),")"]}),"\n"]}),"\n",(0,l.jsx)(s.h2,{id:"operational-guidance",children:"Operational guidance"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:["Fallback state responses (",(0,l.jsx)(s.code,{children:"*"}),", ",(0,l.jsx)(s.code,{children:"ANY"}),") are executed natively."]}),"\n",(0,l.jsx)(s.li,{children:"keep at least one response for each terminal state"}),"\n",(0,l.jsxs)(s.li,{children:["use phase-scoped rules instead of overloading one monolithic ",(0,l.jsx)(s.code,{children:"PIPELINE_RULES"})," pass"]}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,l.jsx)(s,{...e,children:(0,l.jsx)(a,{...e})}):a(e)}}}]);