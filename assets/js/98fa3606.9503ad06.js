"use strict";(globalThis.webpackChunkconvengine_docs=globalThis.webpackChunkconvengine_docs||[]).push([[8962],{7496(e,t,n){n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>c,default:()=>u,frontMatter:()=>r,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"deep-dive/pipeline-steps","title":"Pipeline & Steps","description":"<DbTable","source":"@site/docs/v1/deep-dive/pipeline-steps.mdx","sourceDirName":"deep-dive","slug":"/deep-dive/pipeline-steps","permalink":"/docs/v1/deep-dive/pipeline-steps","draft":false,"unlisted":false,"editUrl":"https://github.com/salilvnair/convengine-docs/tree/main/docs/v1/deep-dive/pipeline-steps.mdx","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"title":"Pipeline & Steps","sidebar_position":4,"hide_table_of_contents":true},"sidebar":"docSidebar","previous":{"title":"File Map","permalink":"/docs/v1/deep-dive/file-map"},"next":{"title":"Intent & Schema","permalink":"/docs/v1/deep-dive/intent-and-schema"}}');var s=n(4848),o=n(8453),a=n(9131);const r={title:"Pipeline & Steps",sidebar_position:4,hide_table_of_contents:!0},c="Pipeline Steps (what each step does)",p={},l=[];function d(e){const t={admonition:"admonition",code:"code",h1:"h1",header:"header",li:"li",p:"p",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"pipeline-steps-what-each-step-does",children:"Pipeline Steps (what each step does)"})}),"\n",(0,s.jsx)(a.p,{title:"Step responsibilities",columns:["Step","Primary responsibility","Main session mutations","Config/table dependencies"],rows:[["LoadOrCreateConversationStep","Fetch or bootstrap conversation row","conversation, intent/state/context sync","ce_conversation"],["ResetConversationStep","Early explicit reset","intent/state/context/input params reset","input flags, command text"],["PersistConversationBootstrapStep","Ensure conversation row persisted","none/metadata","ce_conversation"],["AuditUserInputStep","Persist user input audit","none","ce_audit"],["PolicyEnforcementStep","Policy block and stop","payload + stop result on block","ce_policy"],["IntentResolutionStep","Resolve intent with classifier+agent","intent/state/clarification fields","ce_intent, ce_intent_classifier, ce_config"],["ResetResolvedIntentStep","Reset on configured reset intent","full reset","ce_config RESET_INTENT_CODES"],["FallbackIntentStateStep","Fill missing intent/state defaults","intent/state","none"],["AddContainerDataStep","Fetch and attach container data","containerData/context merge","ce_container_config"],["McpToolStep","MCP planner/tool loop","context_json.mcp.*","ce_mcp_tool, ce_mcp_db_tool, ce_config"],["SchemaExtractionStep","Schema-driven extraction and lock handling","schema facts/context/lock","ce_output_schema, ce_prompt_template"],["AutoAdvanceStep","Compute schema status facts","schemaComplete/hasAny","resolved schema + context"],["RulesStep","Match and apply transitions/actions","intent/state/input params","ce_rule"],["ResponseResolutionStep","Resolve and generate output payload","payload/last assistant json","ce_response, ce_prompt_template"],["PersistConversationStep","Persist final conversation and result","finalResult","ce_conversation"],["PipelineEndGuardStep","Timing audit + terminal guard","timings","ce_audit"]]}),"\n",(0,s.jsx)(t.admonition,{title:"Hook where you need precision",type:"tip",children:(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Before schema extraction: normalize inputs"}),"\n",(0,s.jsx)(t.li,{children:"After rules: inspect intent/state transition correctness"}),"\n",(0,s.jsx)(t.li,{children:"Before response resolution: inject display hints"}),"\n"]})}),"\n",(0,s.jsx)(a.f4,{type:"warning",title:"Don\u2019t hardcode transitions in steps",children:(0,s.jsxs)(t.p,{children:["Prefer transitions in ",(0,s.jsx)(t.code,{children:"ce_rule"})," unless absolutely framework-level behavior is required. This keeps domain behavior data-driven and testable via audit traces."]})})]})}function u(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);