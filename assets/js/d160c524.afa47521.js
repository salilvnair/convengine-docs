"use strict";(globalThis.webpackChunkconvengine_docs=globalThis.webpackChunkconvengine_docs||[]).push([[430],{1796(e,n,i){i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>u,frontMatter:()=>l,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"consumer/session-reset-and-continuity","title":"Session, Reset, Continuity","description":"What is restored per turn","source":"@site/docs/consumer/session-reset-and-continuity.mdx","sourceDirName":"consumer","slug":"/consumer/session-reset-and-continuity","permalink":"/docs/consumer/session-reset-and-continuity","draft":false,"unlisted":false,"editUrl":"https://github.com/salilvnair/convengine-docs/tree/main/docs/consumer/session-reset-and-continuity.mdx","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"title":"Session, Reset, Continuity","sidebar_position":4},"sidebar":"docSidebar","previous":{"title":"Extensions","permalink":"/docs/consumer/extensions"},"next":{"title":"REST API","permalink":"/docs/api/rest-api"}}');var t=i(4848),c=i(8453),r=i(9131);const l={title:"Session, Reset, Continuity",sidebar_position:4},o="Session, Reset, and Continuity",d={},a=[{value:"What is restored per turn",id:"what-is-restored-per-turn",level:2},{value:"Intent lock lifecycle",id:"intent-lock-lifecycle",level:2},{value:"Sticky intent lifecycle (<code>ce_config</code>)",id:"sticky-intent-lifecycle-ce_config",level:2},{value:"Reset triggers",id:"reset-triggers",level:2},{value:"Practical advice",id:"practical-advice",level:2}];function h(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",ul:"ul",...(0,c.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"session-reset-and-continuity",children:"Session, Reset, and Continuity"})}),"\n",(0,t.jsx)(n.h2,{id:"what-is-restored-per-turn",children:"What is restored per turn"}),"\n",(0,t.jsxs)(n.p,{children:["From ",(0,t.jsx)(n.code,{children:"ce_conversation"}),", session restores:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"intent_code"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"state_code"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"context_json"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"input_params_json"})}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"From context branch values, session also restores cross-turn values such as clarification and intent lock metadata."}),"\n",(0,t.jsx)(n.h2,{id:"intent-lock-lifecycle",children:"Intent lock lifecycle"}),"\n",(0,t.jsx)(n.p,{children:"Intent lock is used for incomplete schema collection to avoid drift."}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"lock set when required schema fields are still missing"}),"\n",(0,t.jsx)(n.li,{children:"intent resolver skip logic respects lock"}),"\n",(0,t.jsx)(n.li,{children:"lock removed when schema is complete or schema path is absent"}),"\n"]}),"\n",(0,t.jsxs)(n.h2,{id:"sticky-intent-lifecycle-ce_config",children:["Sticky intent lifecycle (",(0,t.jsx)(n.code,{children:"ce_config"}),")"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"IntentResolutionStep.STICKY_INTENT"})," applies during active incomplete schema collection to keep intent stable while required fields are still missing."]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["when enabled, ",(0,t.jsx)(n.code,{children:"IntentResolutionStep"})," skips re-resolution only while incomplete schema collection is active"]}),"\n",(0,t.jsxs)(n.li,{children:["skip emits audit stage: ",(0,t.jsx)(n.code,{children:"INTENT_RESOLVE_SKIPPED_STICKY_INTENT"})]}),"\n",(0,t.jsx)(n.li,{children:"re-resolution runs once schema collection is complete, and still runs for explicit switch/reset/force signals"}),"\n"]}),"\n",(0,t.jsx)(r.vl,{title:"Sticky intent config",language:"sql",children:"INSERT INTO ce_config (config_type, config_key, config_value, enabled)\nVALUES ('IntentResolutionStep', 'STICKY_INTENT', 'true', true);"}),"\n",(0,t.jsx)(n.p,{children:"Force re-resolution signals:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["reset commands: ",(0,t.jsx)(n.code,{children:"reset"}),", ",(0,t.jsx)(n.code,{children:"restart"}),", ",(0,t.jsx)(n.code,{children:"/reset"}),", ",(0,t.jsx)(n.code,{children:"/restart"})]}),"\n",(0,t.jsxs)(n.li,{children:["switch phrases: ",(0,t.jsx)(n.code,{children:"switch to ..."}),", ",(0,t.jsx)(n.code,{children:"switch intent"}),", ",(0,t.jsx)(n.code,{children:"change intent/flow/mode"})]}),"\n",(0,t.jsxs)(n.li,{children:["input params: ",(0,t.jsx)(n.code,{children:"force_intent_resolution=true"}),", ",(0,t.jsx)(n.code,{children:"resolve_intent=true"}),", ",(0,t.jsx)(n.code,{children:"switch_intent=true"}),", ",(0,t.jsx)(n.code,{children:"switch_flow=true"}),", ",(0,t.jsx)(n.code,{children:"switch_mode=true"})]}),"\n",(0,t.jsx)(n.li,{children:"active clarification flow"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"reset-triggers",children:"Reset triggers"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["request body ",(0,t.jsx)(n.code,{children:"reset=true"})]}),"\n",(0,t.jsxs)(n.li,{children:["input params ",(0,t.jsx)(n.code,{children:"reset"}),", ",(0,t.jsx)(n.code,{children:"restart"}),", ",(0,t.jsx)(n.code,{children:"conversation_reset"})]}),"\n",(0,t.jsxs)(n.li,{children:["text commands ",(0,t.jsx)(n.code,{children:"reset"}),", ",(0,t.jsx)(n.code,{children:"restart"}),", ",(0,t.jsx)(n.code,{children:"/reset"}),", ",(0,t.jsx)(n.code,{children:"/restart"})]}),"\n",(0,t.jsxs)(n.li,{children:["intent-based reset via ",(0,t.jsx)(n.code,{children:"ResetResolvedIntentStep"})," (",(0,t.jsx)(n.code,{children:"ce_config"}),")"]}),"\n"]}),"\n",(0,t.jsx)(r.vl,{title:"Reset intent config",language:"sql",children:"INSERT INTO ce_config (config_type, config_key, config_value, enabled)\nVALUES ('ResetResolvedIntentStep', 'RESET_INTENT_CODES', 'RESET_SESSION,START_OVER', true);"}),"\n",(0,t.jsx)(n.h2,{id:"practical-advice",children:"Practical advice"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Keep reset intent names explicit and reserved (",(0,t.jsx)(n.code,{children:"RESET_SESSION"})," style)"]}),"\n",(0,t.jsx)(n.li,{children:"Avoid mixing business intents with reset intents"}),"\n",(0,t.jsxs)(n.li,{children:["Audit ",(0,t.jsx)(n.code,{children:"CONVERSATION_RESET"})," stages in pre-production tests"]}),"\n"]}),"\n",(0,t.jsx)(r.f4,{type:"warning",title:"Common failure mode",children:(0,t.jsx)(n.p,{children:"If reset logic is custom-coded only in controller, multi-turn state may still leak from existing conversation context. Use pipeline reset steps, not ad-hoc request branching."})})]})}function u(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}}}]);