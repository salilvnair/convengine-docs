"use strict";(globalThis.webpackChunkconvengine_docs=globalThis.webpackChunkconvengine_docs||[]).push([[7548],{484(e,n,t){t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>d,v2PipelineSteps:()=>p});const i=JSON.parse('{"id":"deep-dive/lifecycle","title":"Request Lifecycle","description":"This page is the quick lifecycle view. For the full interactive debug tree, open /docs/v2/deep-dive/request-lifecycle.","source":"@site/docs/v2/deep-dive/lifecycle.mdx","sourceDirName":"deep-dive","slug":"/deep-dive/lifecycle","permalink":"/docs/v2/deep-dive/lifecycle","draft":false,"unlisted":false,"editUrl":"https://github.com/salilvnair/convengine-docs/tree/main/docs/v2/deep-dive/lifecycle.mdx","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"title":"Request Lifecycle","sidebar_position":2,"hide_table_of_contents":true},"sidebar":"docSidebar","previous":{"title":"Deep Dive","permalink":"/docs/v2/deep-dive/"},"next":{"title":"Real World Examples","permalink":"/docs/v2/deep-dive/examples"}}');var s=t(4848),o=t(8453),a=t(7555);const r={title:"Request Lifecycle",sidebar_position:2,hide_table_of_contents:!0},c="Request Lifecycle",l={},p=[{name:"LoadOrCreateConversationStep",description:"Hydrates existing conversation or creates new conversation shell."},{name:"CacheInspectAuditStep",description:"Conditionally audits cache snapshot when cache-inspector enabled."},{name:"ResetConversationStep",description:"Applies reset/start-over command handling."},{name:"PersistConversationBootstrapStep",description:"Persists conversation bootstrap row before persisted-required steps."},{name:"AuditUserInputStep",description:"Writes raw user input audit event."},{name:"PolicyEnforcementStep",description:"Applies pre-intent policy checks and safe short-circuit when required."},{name:"DialogueActStep",description:"Classifies turn as AFFIRM/NEGATE/EDIT/RESET/QUESTION/NEW_REQUEST."},{name:"InteractionPolicyStep",description:"Decides EXECUTE_PENDING_ACTION / REJECT_PENDING_ACTION / FILL_PENDING_SLOT / RECLASSIFY_INTENT."},{name:"ActionLifecycleStep",description:"Maintains pending_action_runtime status with TTL semantics."},{name:"DisambiguationStep",description:"When multiple actions are eligible, asks targeted clarification and pauses execution."},{name:"GuardrailStep",description:"Sanitization + sensitive checks + approval gate hooks."},{name:"IntentResolutionStep",description:"Resolves intent unless policy says skip_intent_resolution."},{name:"ResetResolvedIntentStep",description:"Applies post-intent reset mapping."},{name:"FallbackIntentStateStep",description:"Assigns fallback UNKNOWN flow when intent/state unresolved."},{name:"AddContainerDataStep",description:"Merges configured container data into runtime context."},{name:"PendingActionStep",description:"Executes or rejects pending action task via CeTaskExecutor."},{name:"ToolOrchestrationStep",description:"Unified tool request->execute->result contract by tool_group."},{name:"McpToolStep",description:"Planner loop for CALL_TOOL/ANSWER with MCP observations."},{name:"SchemaExtractionStep",description:"Parses/extracts structured schema fields."},{name:"AutoAdvanceStep",description:"Advances state when schema/task facts satisfy conditions."},{name:"RulesStep",description:"Runs phase-scoped rules and actions with cascade passes."},{name:"StateGraphStep",description:"Validate-only transition check, no forced state mutation."},{name:"ResponseResolutionStep",description:"Resolves EXACT/DERIVED response output."},{name:"MemoryStep",description:"Writes session summary and optional recall memory."},{name:"PersistConversationStep",description:"Persists conversation/result/audit metadata."},{name:"PipelineEndGuardStep",description:"Final guard and timing closure."}],d=[{value:"1. API Entry Point",id:"1-api-entry-point",level:2},{value:"2. Engine Processing",id:"2-engine-processing",level:2},{value:"3. The Pipeline (Step-by-Step)",id:"3-the-pipeline-step-by-step",level:2}];function u(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",p:"p",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"request-lifecycle",children:"Request Lifecycle"})}),"\n",(0,s.jsxs)(n.p,{children:["This page is the quick lifecycle view. For the full interactive debug tree, open ",(0,s.jsx)(a.Mn,{children:"/docs/v2/deep-dive/request-lifecycle"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"1-api-entry-point",children:"1. API Entry Point"}),"\n",(0,s.jsxs)(n.p,{children:["The journey begins when a client sends a POST request to ",(0,s.jsx)(n.code,{children:"/api/v1/conversation/message"}),"."]}),"\n",(0,s.jsx)(a.vl,{title:"ConversationController.message",language:"java",packagePath:"com.github.salilvnair.convengine.api.controller",filePath:"src/main/java/com/github/salilvnair/convengine/api/controller/ConversationController.java",children:'@PostMapping("/message")\npublic ConversationResponse message(@RequestBody ConversationRequest request) {\nEngineContext engineContext = EngineContext.builder()\n    .conversationId(request.getConversationId())\n    .userText(request.getMessage())\n    .inputParams(request.getInputParams())\n    .build();\n\nEngineResult result = engine.process(engineContext);\n\nreturn mapToResponse(result);\n}'}),"\n",(0,s.jsx)(n.h2,{id:"2-engine-processing",children:"2. Engine Processing"}),"\n",(0,s.jsx)(a.vl,{title:"DefaultConversationalEngine.process",language:"java",packagePath:"com.github.salilvnair.convengine.engine.provider",filePath:"src/main/java/com/github/salilvnair/convengine/engine/provider/DefaultConversationalEngine.java",children:"@Override\npublic EngineResult process(EngineContext engineContext) {\nEngineSession session = sessionFactory.open(engineContext);\nsession.setConversationHistory(historyProvider.lastTurns(session.getConversationId(), 10));\nEnginePipeline pipeline = pipelineFactory.create();\nreturn pipeline.execute(session);\n}"}),"\n",(0,s.jsx)(n.h2,{id:"3-the-pipeline-step-by-step",children:"3. The Pipeline (Step-by-Step)"}),"\n",(0,s.jsx)(a.Ve,{ariaLabel:"Pipeline step-by-step (v2)",steps:p}),"\n",(0,s.jsx)(a.f4,{type:"info",title:"Core path vs conditional steps",children:(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"DialogueActStep"}),", ",(0,s.jsx)(n.code,{children:"InteractionPolicyStep"}),", ",(0,s.jsx)(n.code,{children:"ActionLifecycleStep"}),", ",(0,s.jsx)(n.code,{children:"DisambiguationStep"}),", ",(0,s.jsx)(n.code,{children:"PendingActionStep"}),", ",(0,s.jsx)(n.code,{children:"ToolOrchestrationStep"}),", ",(0,s.jsx)(n.code,{children:"McpToolStep"}),", ",(0,s.jsx)(n.code,{children:"StateGraphStep"}),", and ",(0,s.jsx)(n.code,{children:"MemoryStep"})," are route-conditional and execute only when their prerequisites are met."]})}),"\n",(0,s.jsx)(a.f4,{type:"success",title:"Audit Trail + Real-world trace",children:(0,s.jsxs)(n.p,{children:["Every step emits audit events. Use ",(0,s.jsx)(n.code,{children:"/audit/{id}/trace"}),", then open ",(0,s.jsx)(a.Mn,{children:"/docs/v2/deep-dive/request-lifecycle"})," and ",(0,s.jsx)(a.Mn,{children:"/docs/v2/deep-dive/examples"})," to compare turn-by-turn real-world traces."]})})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(u,{...e})}):u(e)}}}]);