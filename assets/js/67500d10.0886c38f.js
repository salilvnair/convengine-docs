"use strict";(globalThis.webpackChunkconvengine_docs=globalThis.webpackChunkconvengine_docs||[]).push([[918],{1470(e,t,s){s.d(t,{A:()=>R});var n=s(6540),a=s(4164),i=s(7559),l=s(3104),o=s(6347),r=s(205),c=s(7485),d=s(1682),u=s(679);function p(e){return n.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,n.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function m(e){const{values:t,children:s}=e;return(0,n.useMemo)(()=>{const e=t??function(e){return p(e).map(({props:{value:e,label:t,attributes:s,default:n}})=>({value:e,label:t,attributes:s,default:n}))}(s);return function(e){const t=(0,d.XI)(e,(e,t)=>e.value===t.value);if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e},[t,s])}function g({value:e,tabValues:t}){return t.some(t=>t.value===e)}function h({queryString:e=!1,groupId:t}){const s=(0,o.W6)(),a=function({queryString:e=!1,groupId:t}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:e,groupId:t});return[(0,c.aZ)(a),(0,n.useCallback)(e=>{if(!a)return;const t=new URLSearchParams(s.location.search);t.set(a,e),s.replace({...s.location,search:t.toString()})},[a,s])]}function _(e){const{defaultValue:t,queryString:s=!1,groupId:a}=e,i=m(e),[l,o]=(0,n.useState)(()=>function({defaultValue:e,tabValues:t}){if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!g({value:e,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${t.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const s=t.find(e=>e.default)??t[0];if(!s)throw new Error("Unexpected error: 0 tabValues");return s.value}({defaultValue:t,tabValues:i})),[c,d]=h({queryString:s,groupId:a}),[p,_]=function({groupId:e}){const t=function(e){return e?`docusaurus.tab.${e}`:null}(e),[s,a]=(0,u.Dv)(t);return[s,(0,n.useCallback)(e=>{t&&a.set(e)},[t,a])]}({groupId:a}),S=(()=>{const e=c??p;return g({value:e,tabValues:i})?e:null})();(0,r.A)(()=>{S&&o(S)},[S]);return{selectedValue:l,selectValue:(0,n.useCallback)(e=>{if(!g({value:e,tabValues:i}))throw new Error(`Can't select invalid tab value=${e}`);o(e),d(e),_(e)},[d,_,i]),tabValues:i}}var S=s(2303);const x="tabList__CuJ",E="tabItem_LNqP";var v=s(4848);function b({className:e,block:t,selectedValue:s,selectValue:n,tabValues:i}){const o=[],{blockElementScrollPositionUntilNextRender:r}=(0,l.a_)(),c=e=>{const t=e.currentTarget,a=o.indexOf(t),l=i[a].value;l!==s&&(r(t),n(l))},d=e=>{let t=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const s=o.indexOf(e.currentTarget)+1;t=o[s]??o[0];break}case"ArrowLeft":{const s=o.indexOf(e.currentTarget)-1;t=o[s]??o[o.length-1];break}}t?.focus()};return(0,v.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,a.A)("tabs",{"tabs--block":t},e),children:i.map(({value:e,label:t,attributes:n})=>(0,v.jsx)("li",{role:"tab",tabIndex:s===e?0:-1,"aria-selected":s===e,ref:e=>{o.push(e)},onKeyDown:d,onClick:c,...n,className:(0,a.A)("tabs__item",E,n?.className,{"tabs__item--active":s===e}),children:t??e},e))})}function f({lazy:e,children:t,selectedValue:s}){const i=(Array.isArray(t)?t:[t]).filter(Boolean);if(e){const e=i.find(e=>e.props.value===s);return e?(0,n.cloneElement)(e,{className:(0,a.A)("margin-top--md",e.props.className)}):null}return(0,v.jsx)("div",{className:"margin-top--md",children:i.map((e,t)=>(0,n.cloneElement)(e,{key:t,hidden:e.props.value!==s}))})}function T(e){const t=_(e);return(0,v.jsxs)("div",{className:(0,a.A)(i.G.tabs.container,"tabs-container",x),children:[(0,v.jsx)(b,{...t,...e}),(0,v.jsx)(f,{...t,...e})]})}function R(e){const t=(0,S.A)();return(0,v.jsx)(T,{...e,children:p(e.children)},String(t))}},2708(e,t,s){s.r(t),s.d(t,{assets:()=>u,contentTitle:()=>d,default:()=>j,disconnectDetails:()=>S,disconnectEdges:()=>_,disconnectNodes:()=>h,faqDetails:()=>g,faqEdges:()=>m,faqNodes:()=>p,frontMatter:()=>c,logDetails:()=>v,logEdges:()=>E,logNodes:()=>x,metadata:()=>n,toc:()=>R,trackerDetails:()=>T,trackerEdges:()=>f,trackerNodes:()=>b});const n=JSON.parse('{"id":"examples","title":"Examples","description":"This page is the practical E2E companion to deep dive. Each example shows:","source":"@site/docs/examples.mdx","sourceDirName":".","slug":"/examples","permalink":"/docs/examples","draft":false,"unlisted":false,"editUrl":"https://github.com/salilvnair/convengine-docs/tree/main/docs/examples.mdx","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"title":"Examples","sidebar_position":3},"sidebar":"docSidebar","previous":{"title":"Architecture","permalink":"/docs/architecture"},"next":{"title":"Local Development","permalink":"/docs/local-development"}}');var a=s(4848),i=s(8453),l=s(1470),o=s(9365),r=s(3224);const c={title:"Examples",sidebar_position:3},d="Examples (ReactFlow + DML + Audit)",u={},p=[{id:"faq_api",position:{x:20,y:60},data:{label:"ConversationController.message"}},{id:"faq_engine",position:{x:290,y:60},data:{label:"DefaultConversationalEngine.process"}},{id:"faq_intent",position:{x:560,y:60},data:{label:"IntentResolutionStep"}},{id:"faq_rules",position:{x:830,y:60},data:{label:"RulesStep"}},{id:"faq_resp",position:{x:290,y:220},data:{label:"ResponseResolutionStep"}},{id:"faq_persist",position:{x:560,y:220},data:{label:"PersistConversationStep"}}],m=[{id:"faq_e1",source:"faq_api",target:"faq_engine"},{id:"faq_e2",source:"faq_engine",target:"faq_intent"},{id:"faq_e3",source:"faq_intent",target:"faq_rules"},{id:"faq_e4",source:"faq_rules",target:"faq_resp"},{id:"faq_e5",source:"faq_resp",target:"faq_persist"}],g={faq_api:{title:"API entry",file:"api/controller/ConversationController.java",method:"message(...) ",stage:"HTTP_ENTRY",summary:"Builds EngineContext and delegates to engine.",session:["message + params normalized"],tables:["none"]},faq_engine:{title:"Engine processing",file:"engine/provider/DefaultConversationalEngine.java",method:"process(...) ",stage:"ENGINE_ENTRY",summary:"Opens session and executes pipeline.",session:["conversation history attached"],tables:["ce_conversation (R)"]},faq_intent:{title:"Intent resolution",file:"engine/steps/IntentResolutionStep.java",method:"execute(...) ",stage:"INTENT_RESOLVED",summary:"Classifier/agent resolve FAQ.",session:["intent=FAQ"],tables:["ce_intent, ce_intent_classifier"]},faq_rules:{title:"Rules evaluation",file:"engine/steps/RulesStep.java",method:"execute(...) ",stage:"RULE_NO_MATCH",summary:"No transition, state remains.",session:["state unchanged"],tables:["ce_rule"]},faq_resp:{title:"Response resolution",file:"engine/steps/ResponseResolutionStep.java",method:"execute(...) ",stage:"ASSISTANT_OUTPUT",summary:"Selects EXACT/TEXT response row.",session:["payload ready"],tables:["ce_response"]},faq_persist:{title:"Persist",file:"engine/steps/PersistConversationStep.java",method:"execute(...) ",stage:"CONVERSATION_PERSIST",summary:"Persists final session snapshot.",session:["context + payload stored"],tables:["ce_conversation (W)"]}},h=[{id:"d_intent",position:{x:20,y:60},data:{label:"IntentResolutionStep"}},{id:"d_schema",position:{x:300,y:60},data:{label:"SchemaExtractionStep"}},{id:"d_followup",position:{x:580,y:60},data:{label:"Follow-up response"}},{id:"d_turn2",position:{x:860,y:60},data:{label:"Turn 2 resume"}},{id:"d_rules",position:{x:300,y:220},data:{label:"RulesStep"}},{id:"d_done",position:{x:580,y:220},data:{label:"Response + Persist"}}],_=[{id:"d_e1",source:"d_intent",target:"d_schema"},{id:"d_e2",source:"d_schema",target:"d_followup"},{id:"d_e3",source:"d_followup",target:"d_turn2"},{id:"d_e4",source:"d_turn2",target:"d_rules"},{id:"d_e5",source:"d_rules",target:"d_done"}],S={d_intent:{title:"Intent",file:"engine/steps/IntentResolutionStep.java",method:"execute(...) ",stage:"INTENT_RESOLVED",summary:"Resolves DISCONNECT_ELECTRICITY.",session:["intent fixed"],tables:["ce_intent"]},d_schema:{title:"Schema extraction",file:"engine/steps/SchemaExtractionStep.java",method:"execute(...) ",stage:"SCHEMA_INCOMPLETE",summary:"Missing fields are detected and intent is locked.",session:["missingFields tracked"],tables:["ce_output_schema, ce_prompt_template"]},d_followup:{title:"Clarification",file:"engine/steps/ResponseResolutionStep.java",method:"execute(...) ",stage:"ASSISTANT_OUTPUT",summary:"Returns follow-up for missing fields.",session:["follow-up payload"],tables:["ce_response"]},d_turn2:{title:"Session continuity",file:"engine/steps/LoadOrCreateConversationStep.java",method:"execute(...) ",stage:"SESSION_REHYDRATE",summary:"Restores same conversation context.",session:["existing context loaded"],tables:["ce_conversation"]},d_rules:{title:"Transition",file:"engine/steps/RulesStep.java",method:"execute(...) ",stage:"RULE_MATCHED",summary:"Applies state transition once schema complete.",session:["state moved"],tables:["ce_rule"]},d_done:{title:"Finalization",file:"engine/steps/ResponseResolutionStep.java",method:"execute(...) ",stage:"CONVERSATION_PERSIST",summary:"Sends final message and persists.",session:["final payload"],tables:["ce_response, ce_conversation"]}},x=[{id:"l_intent",position:{x:20,y:60},data:{label:"IntentResolutionStep"}},{id:"l_schema",position:{x:300,y:60},data:{label:"SchemaExtractionStep"}},{id:"l_rules",position:{x:580,y:60},data:{label:"RulesStep (GET_SCHEMA_JSON)"}},{id:"l_resp",position:{x:860,y:60},data:{label:"ResponseResolutionStep (DERIVED)"}}],E=[{id:"l_e1",source:"l_intent",target:"l_schema"},{id:"l_e2",source:"l_schema",target:"l_rules"},{id:"l_e3",source:"l_rules",target:"l_resp"}],v={l_intent:{title:"Intent",file:"engine/steps/IntentResolutionStep.java",method:"execute(...) ",stage:"INTENT_RESOLVED",summary:"LOG_ANALYSIS selected.",session:["intent=LOG_ANALYSIS"],tables:["ce_intent"]},l_schema:{title:"Extracted facts",file:"engine/steps/SchemaExtractionStep.java",method:"execute(...) ",stage:"SCHEMA_EVALUATED",summary:"Extracts structured fields from logs.",session:["schemaJson prepared"],tables:["ce_output_schema"]},l_rules:{title:"Rule action",file:"engine/steps/RulesStep.java",method:"execute(...) ",stage:"RULE_MATCHED",summary:"GET_SCHEMA_JSON action reads extracted values.",session:["rule context enriched"],tables:["ce_rule"]},l_resp:{title:"Derived answer",file:"engine/steps/ResponseResolutionStep.java",method:"execute(...) ",stage:"ASSISTANT_OUTPUT",summary:"Prompt template creates RCA summary.",session:["derived response"],tables:["ce_prompt_template, ce_response"]}},b=[{id:"t_intent",position:{x:20,y:60},data:{label:"IntentResolutionStep"}},{id:"t_schema",position:{x:300,y:60},data:{label:"SchemaExtractionStep"}},{id:"t_rules",position:{x:580,y:60},data:{label:"RulesStep (SET_TASK)"}},{id:"t_resp",position:{x:860,y:60},data:{label:"ResponseResolutionStep"}}],f=[{id:"t_e1",source:"t_intent",target:"t_schema"},{id:"t_e2",source:"t_schema",target:"t_rules"},{id:"t_e3",source:"t_rules",target:"t_resp"}],T={t_intent:{title:"Intent",file:"engine/steps/IntentResolutionStep.java",method:"execute(...) ",stage:"INTENT_RESOLVED",summary:"REQUEST_TRACKER selected.",session:["intent=REQUEST_TRACKER"],tables:["ce_intent"]},t_schema:{title:"Extraction",file:"engine/steps/SchemaExtractionStep.java",method:"execute(...) ",stage:"SCHEMA_EVALUATED",summary:"Extracts requestId.",session:["requestId available"],tables:["ce_output_schema"]},t_rules:{title:"Task assignment",file:"engine/steps/RulesStep.java",method:"execute(...) ",stage:"RULE_MATCHED",summary:"SET_TASK marks consumer work.",session:["task set"],tables:["ce_rule"]},t_resp:{title:"Output",file:"engine/steps/ResponseResolutionStep.java",method:"execute(...) ",stage:"ASSISTANT_OUTPUT",summary:"Builds final status message.",session:["payload finalized"],tables:["ce_response"]}},R=[{value:"Canonical Runtime Step Set",id:"canonical-runtime-step-set",level:2},{value:"FAQ",id:"faq",level:2},{value:"DISCONNECT_ELECTRICITY",id:"disconnect_electricity",level:2},{value:"LOG_ANALYSIS",id:"log_analysis",level:2},{value:"REQUEST_TRACKER",id:"request_tracker",level:2}];function C(e){const t={h1:"h1",h2:"h2",header:"header",li:"li",p:"p",ul:"ul",...(0,i.R)(),...e.components},{Details:s}=t;return s||function(e,t){throw new Error("Expected "+(t?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.header,{children:(0,a.jsx)(t.h1,{id:"examples-reactflow--dml--audit",children:"Examples (ReactFlow + DML + Audit)"})}),"\n",(0,a.jsx)(t.p,{children:"This page is the practical E2E companion to deep dive. Each example shows:"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:"conversation UX"}),"\n",(0,a.jsx)(t.li,{children:"runtime flow graph"}),"\n",(0,a.jsx)(t.li,{children:"DML seed rows"}),"\n",(0,a.jsx)(t.li,{children:"expected audit stages"}),"\n"]}),"\n",(0,a.jsx)(t.h2,{id:"canonical-runtime-step-set",children:"Canonical Runtime Step Set"}),"\n",(0,a.jsx)(r.f4,{type:"info",title:"Step loop behavior",children:(0,a.jsxs)(t.p,{children:["Step loop invokes each ",(0,a.jsx)(r.pu,{children:"execute(session)"}),". If a step returns ",(0,a.jsx)(r.pu,{children:"Stop"}),", response returns immediately; otherwise loop continues."]})}),"\n",(0,a.jsxs)("div",{className:"ce-step-badge-list",role:"list","aria-label":"Canonical runtime step set",children:[(0,a.jsxs)("div",{className:"ce-step-badge-item",children:[(0,a.jsx)("span",{className:"ce-step-badge-index",children:"1"}),(0,a.jsx)("span",{className:"ce-step-badge-label",children:"LoadOrCreateConversationStep"})]}),(0,a.jsxs)("div",{className:"ce-step-badge-item",children:[(0,a.jsx)("span",{className:"ce-step-badge-index",children:"2"}),(0,a.jsx)("span",{className:"ce-step-badge-label",children:"ResetConversationStep"})]}),(0,a.jsxs)("div",{className:"ce-step-badge-item",children:[(0,a.jsx)("span",{className:"ce-step-badge-index",children:"3"}),(0,a.jsx)("span",{className:"ce-step-badge-label",children:"PersistConversationBootstrapStep"})]}),(0,a.jsxs)("div",{className:"ce-step-badge-item",children:[(0,a.jsx)("span",{className:"ce-step-badge-index",children:"4"}),(0,a.jsx)("span",{className:"ce-step-badge-label",children:"AuditUserInputStep"})]}),(0,a.jsxs)("div",{className:"ce-step-badge-item",children:[(0,a.jsx)("span",{className:"ce-step-badge-index",children:"5"}),(0,a.jsx)("span",{className:"ce-step-badge-label",children:"PolicyEnforcementStep"})]}),(0,a.jsxs)("div",{className:"ce-step-badge-item",children:[(0,a.jsx)("span",{className:"ce-step-badge-index",children:"6"}),(0,a.jsx)("span",{className:"ce-step-badge-label",children:"IntentResolutionStep"})]}),(0,a.jsxs)("div",{className:"ce-step-badge-item",children:[(0,a.jsx)("span",{className:"ce-step-badge-index",children:"7"}),(0,a.jsx)("span",{className:"ce-step-badge-label",children:"ResetResolvedIntentStep"})]}),(0,a.jsxs)("div",{className:"ce-step-badge-item",children:[(0,a.jsx)("span",{className:"ce-step-badge-index",children:"8"}),(0,a.jsx)("span",{className:"ce-step-badge-label",children:"FallbackIntentStateStep"})]}),(0,a.jsxs)("div",{className:"ce-step-badge-item",children:[(0,a.jsx)("span",{className:"ce-step-badge-index",children:"9"}),(0,a.jsx)("span",{className:"ce-step-badge-label",children:"AddContainerDataStep"})]}),(0,a.jsxs)("div",{className:"ce-step-badge-item",children:[(0,a.jsx)("span",{className:"ce-step-badge-index",children:"10"}),(0,a.jsx)("span",{className:"ce-step-badge-label",children:"McpToolStep"})]}),(0,a.jsxs)("div",{className:"ce-step-badge-item",children:[(0,a.jsx)("span",{className:"ce-step-badge-index",children:"11"}),(0,a.jsx)("span",{className:"ce-step-badge-label",children:"SchemaExtractionStep"})]}),(0,a.jsxs)("div",{className:"ce-step-badge-item",children:[(0,a.jsx)("span",{className:"ce-step-badge-index",children:"12"}),(0,a.jsx)("span",{className:"ce-step-badge-label",children:"AutoAdvanceStep"})]}),(0,a.jsxs)("div",{className:"ce-step-badge-item",children:[(0,a.jsx)("span",{className:"ce-step-badge-index",children:"13"}),(0,a.jsx)("span",{className:"ce-step-badge-label",children:"RulesStep"})]}),(0,a.jsxs)("div",{className:"ce-step-badge-item",children:[(0,a.jsx)("span",{className:"ce-step-badge-index",children:"14"}),(0,a.jsx)("span",{className:"ce-step-badge-label",children:"ResponseResolutionStep"})]}),(0,a.jsxs)("div",{className:"ce-step-badge-item",children:[(0,a.jsx)("span",{className:"ce-step-badge-index",children:"15"}),(0,a.jsx)("span",{className:"ce-step-badge-label",children:"PersistConversationStep"})]}),(0,a.jsxs)("div",{className:"ce-step-badge-item",children:[(0,a.jsx)("span",{className:"ce-step-badge-index",children:"16"}),(0,a.jsx)("span",{className:"ce-step-badge-label",children:"PipelineEndGuardStep"})]})]}),"\n",(0,a.jsxs)(s,{className:"ce-trace-details",children:[(0,a.jsx)("summary",{children:"Open full step traversal with snippets"}),(0,a.jsx)(r.vl,{title:"ConversationController.message",language:"java",filePath:"src/main/java/com/github/salilvnair/convengine/api/controller/ConversationController.java",children:'@PostMapping("/message")\npublic ConversationResponse message(@RequestBody ConversationRequest request) {\nUUID conversationId = request.getConversationId() != null\n    ? request.getConversationId() : UUID.randomUUID();\n\nMap<String, Object> inputParams = new LinkedHashMap<>();\nif (request.getInputParams() != null) {\n  inputParams.putAll(request.getInputParams());\n}\n\nEngineContext engineContext = EngineContext.builder()\n    .conversationId(conversationId.toString())\n    .userText(request.getMessage())\n    .inputParams(inputParams)\n    .build();\n\nEngineResult result = engine.process(engineContext);\nreturn mapToResponse(result);\n}'}),(0,a.jsx)(r.vl,{title:"DefaultConversationalEngine.process",language:"java",filePath:"src/main/java/com/github/salilvnair/convengine/engine/provider/DefaultConversationalEngine.java",children:"@Override\npublic EngineResult process(EngineContext engineContext) {\nEngineSession session = sessionFactory.open(engineContext);\nsession.setConversationHistory(historyProvider.lastTurns(session.getConversationId(), 10));\nEnginePipeline pipeline = pipelineFactory.create();\nreturn pipeline.execute(session);\n}"}),(0,a.jsx)(r.vl,{title:"EnginePipeline.execute",language:"java",filePath:"src/main/java/com/github/salilvnair/convengine/engine/pipeline/EnginePipeline.java",children:"public EngineResult execute(EngineSession session) {\nfor (EngineStep step : steps) {\n  StepResult result = step.execute(session);\n  if (result instanceof StepResult.Stop(EngineResult finalResult)) {\n    return finalResult;\n  }\n}\nif (session.getFinalResult() == null) {\n  throw new ConversationEngineException(ConversationEngineErrorCode.PIPELINE_NO_FINAL_RESULT);\n}\nreturn session.getFinalResult();\n}"}),(0,a.jsx)(r.vl,{title:"LoadOrCreateConversationStep.execute",language:"java",filePath:"src/main/java/com/github/salilvnair/convengine/engine/steps/LoadOrCreateConversationStep.java",children:"public StepResult execute(EngineSession session) {\nCeConversation persisted = conversationRepo.findByConversationId(session.getConversationId())\n    .orElseGet(() -> conversationRepo.save(createConversation(session.getConversationId())));\n\nsession.setConversation(persisted);\nsession.setIntent(persisted.getIntentCode());\nsession.setState(persisted.getStateCode());\nsession.mergeContextJson(persisted.getContextJson());\nreturn new StepResult.Continue();\n}"}),(0,a.jsx)(r.vl,{title:"IntentResolutionStep.execute",language:"java",filePath:"src/main/java/com/github/salilvnair/convengine/engine/steps/IntentResolutionStep.java",children:'public StepResult execute(EngineSession session) {\nif (session.isSchemaLocked() && session.hasIntent()) {\n  audit.audit("INTENT_SKIP_LOCKED", session.getConversationId(), Map.of("intent", session.getIntent()));\n  return new StepResult.Continue();\n}\n\nIntentResolutionTrace trace = resolver.resolveWithTrace(session.getUserText(), session.contextDict());\nsession.setIntent(trace.getIntent());\nsession.setState(trace.getState());\n\naudit.audit("INTENT_RESOLVED", session.getConversationId(), Map.of(\n    "intent", trace.getIntent(),\n    "confidence", trace.getConfidence(),\n    "source", trace.getSource()\n));\nreturn new StepResult.Continue();\n}'}),(0,a.jsx)(r.vl,{title:"SchemaExtractionStep.execute",language:"java",filePath:"src/main/java/com/github/salilvnair/convengine/engine/steps/SchemaExtractionStep.java",children:'public StepResult execute(EngineSession session) {\nOptional<CeOutputSchema> schemaOpt = outputSchemaRepo.findEnabled(session.getIntent(), session.getState());\nif (schemaOpt.isEmpty()) {\n  return new StepResult.Continue();\n}\n\nCeOutputSchema schema = schemaOpt.get();\nString prompt = promptRenderer.renderSchemaPrompt(session, schema);\nString extractedJson = llmClient.generateJson(prompt, schema.getSchemaJson(), session.getContextJsonOrEmpty());\n\nsession.mergeContextJson(extractedJson);\nMissingFieldResult missing = missingFieldEvaluator.evaluate(schema.getSchemaJson(), session.contextDict());\nsession.setMissingFields(missing.names());\nsession.setSchemaLocked(!missing.isComplete());\n\naudit.audit("SCHEMA_EVALUATED", session.getConversationId(), Map.of("missing", missing.names()));\nreturn new StepResult.Continue();\n}'}),(0,a.jsx)(r.vl,{title:"RulesStep.execute",language:"java",filePath:"src/main/java/com/github/salilvnair/convengine/engine/steps/RulesStep.java",children:'public StepResult execute(EngineSession session) {\nint pass = 0;\nboolean changed;\ndo {\n  changed = false;\n  pass++;\n  for (CeRule rule : ruleRepo.findEnabled(session.getIntent(), session.getState())) {\n    if (!ruleMatcher.matches(rule, session)) {\n      continue;\n    }\n    RuleOutcome outcome = actionExecutor.apply(rule, session);\n    changed = changed || outcome.mutatedIntentOrState();\n    audit.audit("RULE_MATCHED", session.getConversationId(), Map.of("ruleId", rule.getId(), "action", rule.getAction()));\n  }\n} while (changed && pass < 4);\n\nreturn new StepResult.Continue();\n}'}),(0,a.jsx)(r.vl,{title:"ResponseResolutionStep.execute",language:"java",filePath:"src/main/java/com/github/salilvnair/convengine/engine/steps/ResponseResolutionStep.java",children:'public StepResult execute(EngineSession session) {\nCeResponse row = responseRepo.resolve(session.getIntent(), session.getState())\n    .orElseThrow(() -> new ConversationEngineException(RESPONSE_NOT_FOUND));\n\nEngineResult result = "EXACT".equalsIgnoreCase(row.getResponseType())\n    ? exactResolver.resolve(row, session)\n    : derivedResolver.resolve(row, session);\n\nsession.setFinalResult(result);\naudit.audit("ASSISTANT_OUTPUT", session.getConversationId(), Map.of(\n    "responseType", row.getResponseType(),\n    "outputFormat", row.getOutputFormat()\n));\nreturn new StepResult.Continue();\n}'}),(0,a.jsx)(r.vl,{title:"PersistConversationStep.execute",language:"java",filePath:"src/main/java/com/github/salilvnair/convengine/engine/steps/PersistConversationStep.java",children:"public StepResult execute(EngineSession session) {\nCeConversation c = session.getConversation();\nc.setIntentCode(session.getIntent());\nc.setStateCode(session.getState());\nc.setContextJson(session.getContextJsonOrEmpty());\nc.setLastAssistantJson(session.getFinalResultJson());\nconversationRepo.save(c);\nreturn new StepResult.Continue();\n}"})]}),"\n",(0,a.jsx)(t.h2,{id:"faq",children:"FAQ"}),"\n",(0,a.jsxs)(l.A,{groupId:"example-faq",children:[(0,a.jsxs)(o.A,{value:"conversation",label:"Conversation + Flow",default:!0,children:[(0,a.jsxs)(r.sy,{title:"FAQ",children:[(0,a.jsx)(r.KJ,{children:"Can I move my connection within Zapper?"}),(0,a.jsx)(r.Fb,{children:"Yes. You can request relocation from the support portal."})]}),(0,a.jsx)(r.il,{title:"FAQ runtime flow",subtitle:"Classifier-first deterministic path",nodes:p,edges:m,detailsById:g,defaultSelectedId:"faq_intent"})]}),(0,a.jsxs)(o.A,{value:"dml",label:"DML Entries",children:[(0,a.jsx)(r.vl,{title:"FAQ seed SQL",language:"sql",children:"insert into ce_intent(intent_code, state_code, enabled) values ('FAQ', null, true);\ninsert into ce_intent_classifier(intent_code, match_pattern, priority, enabled)\nvalues ('FAQ', '(?i).*(office|location|address).*', 10, true);\ninsert into ce_response(intent_code, state_code, response_type, output_format, exact_text, enabled)\nvalues ('FAQ', null, 'EXACT', 'TEXT', 'Yes. You can request relocation from the support portal.', true);\ninsert into ce_config(component, config_key, config_value, enabled)\nvalues ('ResetConversationStep', 'RESET_COMMAND', 'RESET_SESSION', true);"}),(0,a.jsx)(r.p,{title:"FAQ seed preview",columns:["Table","Key values"],rows:[["ce_intent","intent_code=FAQ"],["ce_intent_classifier","pattern=(?i).*(office|location|address).*"],["ce_response","response_type=EXACT, output_format=TEXT"],["ce_config","RESET_COMMAND=RESET_SESSION"]]})]}),(0,a.jsx)(o.A,{value:"audit",label:"Audit Trail",children:(0,a.jsx)(r.p,{title:"FAQ expected ce_audit trail",columns:["Stage","Meaning"],rows:[["USER_INPUT","Incoming user message captured"],["INTENT_RESOLVED","FAQ selected"],["RULE_NO_MATCH","No transition rule needed"],["ASSISTANT_OUTPUT","EXACT response emitted"],["CONVERSATION_PERSIST","Session snapshot saved"]]})})]}),"\n",(0,a.jsx)(t.h2,{id:"disconnect_electricity",children:"DISCONNECT_ELECTRICITY"}),"\n",(0,a.jsxs)(l.A,{groupId:"example-disconnect",children:[(0,a.jsxs)(o.A,{value:"conversation",label:"Conversation + Flow",default:!0,children:[(0,a.jsxs)(r.sy,{title:"DISCONNECT_ELECTRICITY",children:[(0,a.jsx)(r.KJ,{children:"Disconnect electricity for account 10004567."}),(0,a.jsx)(r.Fb,{children:"Please share disconnect date and reason."}),(0,a.jsx)(r.KJ,{children:"Date is 2026-03-31, reason moving out."}),(0,a.jsx)(r.Fb,{children:"Done. Request submitted."})]}),(0,a.jsx)(r.il,{title:"Disconnect flow",subtitle:"Incomplete schema -> follow-up -> complete -> finalize",nodes:h,edges:_,detailsById:S,defaultSelectedId:"d_schema"})]}),(0,a.jsx)(o.A,{value:"dml",label:"DML Entries",children:(0,a.jsx)(r.vl,{title:"DISCONNECT_ELECTRICITY seed SQL",language:"sql",children:'insert into ce_intent(intent_code, enabled) values (\'DISCONNECT_ELECTRICITY\', true);\ninsert into ce_output_schema(intent_code, schema_json, enabled)\nvalues (\'DISCONNECT_ELECTRICITY\',\n\'{"type":"object","properties":{"accountId":{"type":"string"},"disconnectDate":{"type":"string"},"reason":{"type":"string"}},"required":["accountId","disconnectDate","reason"]}\',\ntrue);\ninsert into ce_prompt_template(intent_code, state_code, response_type, system_prompt, user_prompt, enabled)\nvalues (\'DISCONNECT_ELECTRICITY\', \'COLLECT_REQUIRED\', \'TEXT\', \'Collect missing disconnect fields.\', \'Ask only for missing disconnect fields from: {{user_input}}\', true);\ninsert into ce_response(intent_code, state_code, response_type, output_format, enabled)\nvalues (\'DISCONNECT_ELECTRICITY\', \'COLLECT_REQUIRED\', \'DERIVED\', \'TEXT\', true);'})}),(0,a.jsx)(o.A,{value:"audit",label:"Audit Trail",children:(0,a.jsx)(r.p,{title:"DISCONNECT_ELECTRICITY expected ce_audit trail",columns:["Stage","Meaning"],rows:[["INTENT_RESOLVED","Intent selected"],["SCHEMA_INCOMPLETE","Missing fields detected"],["ASSISTANT_OUTPUT","Follow-up asked"],["SCHEMA_COMPLETE","All required fields present"],["RULE_MATCHED","State transition executed"],["CONVERSATION_PERSIST","Final state stored"]]})})]}),"\n",(0,a.jsx)(t.h2,{id:"log_analysis",children:"LOG_ANALYSIS"}),"\n",(0,a.jsxs)(l.A,{groupId:"example-log",children:[(0,a.jsxs)(o.A,{value:"conversation",label:"Conversation + Flow",default:!0,children:[(0,a.jsxs)(r.sy,{title:"LOG_ANALYSIS",children:[(0,a.jsx)(r.KJ,{children:"Analyze timeout logs and tell root cause."}),(0,a.jsx)(r.Fb,{children:"Root cause is DB connection pool saturation from 11:02 to 11:07 UTC."})]}),(0,a.jsx)(r.il,{title:"Log analysis flow",subtitle:"GET_SCHEMA_JSON rule and DERIVED output",nodes:x,edges:E,detailsById:v,defaultSelectedId:"l_rules"})]}),(0,a.jsx)(o.A,{value:"dml",label:"DML Entries",children:(0,a.jsx)(r.p,{title:"LOG_ANALYSIS seed preview",columns:["Table","Key values"],rows:[["ce_intent","intent_code=LOG_ANALYSIS"],["ce_output_schema","fields=errorCode,component,severity"],["ce_rule","action=GET_SCHEMA_JSON"],["ce_response","response_type=DERIVED"]]})}),(0,a.jsx)(o.A,{value:"audit",label:"Audit Trail",children:(0,a.jsx)(r.p,{title:"LOG_ANALYSIS expected ce_audit trail",columns:["Stage","Meaning"],rows:[["INTENT_RESOLVED","LOG_ANALYSIS selected"],["SCHEMA_EVALUATED","Structured facts extracted"],["RULE_MATCHED","GET_SCHEMA_JSON evaluated"],["ASSISTANT_OUTPUT","Derived explanation produced"]]})})]}),"\n",(0,a.jsx)(t.h2,{id:"request_tracker",children:"REQUEST_TRACKER"}),"\n",(0,a.jsxs)(l.A,{groupId:"example-tracker",children:[(0,a.jsxs)(o.A,{value:"conversation",label:"Conversation + Flow",default:!0,children:[(0,a.jsxs)(r.sy,{title:"REQUEST_TRACKER",children:[(0,a.jsx)(r.KJ,{children:"Track request REQ-778102."}),(0,a.jsx)(r.Fb,{children:"REQ-778102 is IN_REVIEW and assigned to Queue-3."})]}),(0,a.jsx)(r.il,{title:"Tracker flow",subtitle:"SET_TASK driven state path",nodes:b,edges:f,detailsById:T,defaultSelectedId:"t_rules"})]}),(0,a.jsx)(o.A,{value:"dml",label:"DML Entries",children:(0,a.jsx)(r.p,{title:"REQUEST_TRACKER seed preview",columns:["Table","Key values"],rows:[["ce_intent","intent_code=REQUEST_TRACKER"],["ce_output_schema","field=requestId"],["ce_rule","action=SET_TASK"],["ce_response","response_type=DERIVED"]]})}),(0,a.jsx)(o.A,{value:"audit",label:"Audit Trail",children:(0,a.jsx)(r.p,{title:"REQUEST_TRACKER expected ce_audit trail",columns:["Stage","Meaning"],rows:[["INTENT_RESOLVED","REQUEST_TRACKER selected"],["RULE_MATCHED","SET_TASK applied"],["ASSISTANT_OUTPUT","Status response emitted"],["CONVERSATION_PERSIST","Turn persisted"]]})})]}),"\n",(0,a.jsx)(r.f4,{type:"tip",title:"Fast validation",children:(0,a.jsxs)(t.p,{children:["For each example run, inspect both ",(0,a.jsxs)(r.Mn,{children:["/api/v1/conversation/audit/","{conversationId}"]})," and ",(0,a.jsxs)(r.Mn,{children:["/api/v1/conversation/audit/","{conversationId}","/trace"]}),"."]})})]})}function j(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(C,{...e})}):C(e)}},9365(e,t,s){s.d(t,{A:()=>l});s(6540);var n=s(4164);const a="tabItem_Ymn6";var i=s(4848);function l({children:e,hidden:t,className:s}){return(0,i.jsx)("div",{role:"tabpanel",className:(0,n.A)(a,s),hidden:t,children:e})}}}]);