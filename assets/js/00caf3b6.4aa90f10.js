"use strict";(globalThis.webpackChunkconvengine_docs=globalThis.webpackChunkconvengine_docs||[]).push([[950],{9794(e,n,t){t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>p,frontMatter:()=>r,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"deep-dive/intent-and-schema","title":"Intent & Schema","description":"Intent resolution sources","source":"@site/docs/deep-dive/intent-and-schema.mdx","sourceDirName":"deep-dive","slug":"/deep-dive/intent-and-schema","permalink":"/docs/deep-dive/intent-and-schema","draft":false,"unlisted":false,"editUrl":"https://github.com/salilvnair/convengine-docs/tree/main/docs/deep-dive/intent-and-schema.mdx","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"title":"Intent & Schema","sidebar_position":5,"hide_table_of_contents":true},"sidebar":"docSidebar","previous":{"title":"Pipeline & Steps","permalink":"/docs/deep-dive/pipeline-steps"},"next":{"title":"Rules & Responses","permalink":"/docs/deep-dive/rules-responses"}}');var i=t(4848),o=t(8453),c=t(9131);const r={title:"Intent & Schema",sidebar_position:5,hide_table_of_contents:!0},l="Intent Resolution and Schema Collection",a={},d=[{value:"Intent resolution sources",id:"intent-resolution-sources",level:2},{value:"<code>ce_config</code> keys that shape intent behavior",id:"ce_config-keys-that-shape-intent-behavior",level:2},{value:"<code>ce_prompt_template</code> for schema extraction",id:"ce_prompt_template-for-schema-extraction",level:2},{value:"Intent lock behavior",id:"intent-lock-behavior",level:2}];function h(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"intent-resolution-and-schema-collection",children:"Intent Resolution and Schema Collection"})}),"\n",(0,i.jsx)(n.h2,{id:"intent-resolution-sources",children:"Intent resolution sources"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Deterministic classifier rules (",(0,i.jsx)(n.code,{children:"ce_intent_classifier"}),")"]}),"\n",(0,i.jsxs)(n.li,{children:["Agent scoring path (",(0,i.jsx)(n.code,{children:"AgentIntentResolver"}),") using ",(0,i.jsx)(n.code,{children:"ce_config"})," prompts"]}),"\n",(0,i.jsxs)(n.li,{children:["Composite arbitration in ",(0,i.jsx)(n.code,{children:"CompositeIntentResolver"})]}),"\n"]}),"\n",(0,i.jsxs)(n.h2,{id:"ce_config-keys-that-shape-intent-behavior",children:[(0,i.jsx)(n.code,{children:"ce_config"})," keys that shape intent behavior"]}),"\n",(0,i.jsx)(c.p,{title:"AgentIntentResolver keys",columns:["config_key","Purpose","Example"],rows:[["MIN_CONFIDENCE","Minimum confidence to accept agent intent","0.55"],["COLLISION_GAP_THRESHOLD","Top-score gap threshold for collision","0.10"],["SYSTEM_PROMPT","System behavior contract","JSON-only intent scoring rules"],["USER_PROMPT","User template with context/history/allowed intents","{{context}}, {{allowed_intents}}, {{user_input}}"]]}),"\n",(0,i.jsx)(c.p,{title:"IntentResolutionStep keys",columns:["config_key","Purpose","Example"],rows:[["STICKY_INTENT","Keep resolved intent/state stable across turns and skip unnecessary re-resolution","true"]]}),"\n",(0,i.jsxs)(n.h2,{id:"ce_prompt_template-for-schema-extraction",children:[(0,i.jsx)(n.code,{children:"ce_prompt_template"})," for schema extraction"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"SchemaExtractionStep"})," resolves template by:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"response_type = SCHEMA_JSON"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"intent_code"})}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"state_code"})," (or fallback)"]}),"\n"]}),"\n",(0,i.jsx)(c.vl,{title:"Schema extraction prompt pattern",language:"text",defaultOpen:!1,children:"System prompt:\nExtract only valid JSON that conforms to schema.\nNo extra keys. No prose.\n\nUser prompt:\nUser Input: {{user_input}}\nContext: {{context}}\nSchema: {{schema}}\nConversation History: {{conversation_history}}"}),"\n",(0,i.jsx)(n.h2,{id:"intent-lock-behavior",children:"Intent lock behavior"}),"\n",(0,i.jsx)(n.p,{children:"When schema is incomplete:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"session.intentLocked = true"})}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"IntentResolutionStep"})," skips re-resolving to prevent intent drift"]}),"\n",(0,i.jsxs)(n.li,{children:["lock reason is persisted in context (",(0,i.jsx)(n.code,{children:"intent_lock.reason"}),")"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"When schema becomes complete:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"lock is released"}),"\n",(0,i.jsxs)(n.li,{children:["if ",(0,i.jsx)(n.code,{children:"STICKY_INTENT=true"}),", resolver can still skip and retain existing intent/state"]}),"\n",(0,i.jsx)(n.li,{children:"explicit switch/reset/force signals still allow re-resolution"}),"\n"]}),"\n",(0,i.jsx)(c.f4,{type:"success",title:"Why this matters",children:(0,i.jsx)(n.p,{children:"Without lock behavior, multi-turn collection flows can jump to a new intent after partial input and break deterministic progression."})})]})}function p(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}}}]);