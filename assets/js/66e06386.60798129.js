"use strict";(globalThis.webpackChunkconvengine_docs=globalThis.webpackChunkconvengine_docs||[]).push([[311],{1414(e,t,n){n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>l,default:()=>p,frontMatter:()=>r,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"deep-dive/data-model","title":"Data Model","description":"ConvEngine is configuration-driven. Behavior is defined in the following tables.","source":"@site/docs/deep-dive/data-model.mdx","sourceDirName":"deep-dive","slug":"/deep-dive/data-model","permalink":"/docs/deep-dive/data-model","draft":false,"unlisted":false,"editUrl":"https://github.com/salilvnair/convengine-docs/tree/main/docs/deep-dive/data-model.mdx","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"title":"Data Model","sidebar_position":4,"hide_table_of_contents":true},"sidebar":"docSidebar","previous":{"title":"Real-world Examples (Debug Trace)","permalink":"/docs/deep-dive/examples"},"next":{"title":"Developer Guide","permalink":"/docs/deep-dive/developer-guide"}}');var i=n(4848),s=n(8453),o=n(3224);const r={title:"Data Model",sidebar_position:4,hide_table_of_contents:!0},l="Data Model",d={},c=[{value:"Configuration Tables",id:"configuration-tables",level:2},{value:"Runtime Tables",id:"runtime-tables",level:2},{value:"Common Operations",id:"common-operations",level:2},{value:"Setting a Task (<code>SET_TASK</code> action)",id:"setting-a-task-set_task-action",level:3},{value:"Getting Extracted Data",id:"getting-extracted-data",level:3}];function u(e){const t={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",p:"p",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"data-model",children:"Data Model"})}),"\n",(0,i.jsx)(t.p,{children:"ConvEngine is configuration-driven. Behavior is defined in the following tables."}),"\n",(0,i.jsx)(t.h2,{id:"configuration-tables",children:"Configuration Tables"}),"\n",(0,i.jsx)(o.p,{title:"Core Tables",columns:["Table","Purpose","Key Columns"],rows:[["ce_intent","Defines business intents","intent_code, description, enabled"],["ce_intent_classifier","Regex patterns for intents","match_pattern, priority"],["ce_rule","Logic & State Transitions","rule_type, action, match_pattern"],["ce_response","Output mapping","response_type, output_format, exact_text"],["ce_output_schema","Data extraction definition","json_schema, priority"],["ce_prompt_template","LLM Prompts","system_prompt, user_prompt"]]}),"\n",(0,i.jsx)(t.h2,{id:"runtime-tables",children:"Runtime Tables"}),"\n",(0,i.jsx)(o.p,{title:"Runtime Persistence",columns:["Table","Purpose"],rows:[["ce_conversation","Current state of active conversations"],["ce_audit","Append-only log of every step execution"]]}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsx)(t.h1,{id:"session-api",children:"Session API"}),"\n",(0,i.jsxs)(t.p,{children:["When writing Java extensions (Interceptors, Transformers), you interact with ",(0,i.jsx)(t.code,{children:"EngineSession"}),"."]}),"\n",(0,i.jsx)(o.vl,{title:"EngineSession.java (key methods)",language:"java",packagePath:"com.github.salilvnair.convengine.engine.session",filePath:"src/main/java/com/github/salilvnair/convengine/engine/session/EngineSession.java",children:"// State Management\nvoid setIntent(String intent);\nvoid setState(String state);\n\n// Extras/Input params used by steps, prompts and rules\nMap<String, Object> getInputParams();\nvoid putInputParam(String key, Object value);\n\n// Persisted Entity\nCeConversation getConversation();\n\n// Flow Control\nvoid setFinalResult(EngineResult result); // Stop pipeline immediately"}),"\n",(0,i.jsx)(t.h2,{id:"common-operations",children:"Common Operations"}),"\n",(0,i.jsxs)(t.h3,{id:"setting-a-task-set_task-action",children:["Setting a Task (",(0,i.jsx)(t.code,{children:"SET_TASK"})," action)"]}),"\n",(0,i.jsxs)(t.p,{children:["Tasks are triggered through rule action resolution, not by writing arbitrary ",(0,i.jsx)(t.code,{children:"task"})," keys in context.\nConfigure ",(0,i.jsx)(t.code,{children:"ce_rule.action=SET_TASK"})," and map ",(0,i.jsx)(t.code,{children:"action_value"})," to a Spring task bean method."]}),"\n",(0,i.jsx)(o.vl,{title:"SET_TASK rule row",language:"sql",packagePath:"consumer DB",children:"INSERT INTO ce_rule\n(intent_code, rule_type, match_pattern, action, action_value, priority, enabled, description)\nVALUES\n('REQUEST_TRACKER', 'REGEX', '(?i).*track.*request.*', 'SET_TASK', 'requestTrackerTask:loadStatus', 10, true,\n 'Invoke consumer task bean during rule execution');"}),"\n",(0,i.jsx)(o.vl,{title:"Consumer task bean method",language:"java",packagePath:"consumer logic",children:'@Component("requestTrackerTask")\npublic class RequestTrackerTask implements CeRuleTask {\npublic void loadStatus(EngineSession session, CeRule rule) {\n  // Populate context/input params for downstream response\n  session.putInputParam("requestStatus", "IN_REVIEW");\n}\n}'}),"\n",(0,i.jsx)(t.h3,{id:"getting-extracted-data",children:"Getting Extracted Data"}),"\n",(0,i.jsx)(t.p,{children:"Access data extracted by the Schema Extraction step."}),"\n",(0,i.jsx)(o.vl,{title:"Read extracted value",language:"java",packagePath:"consumer logic",children:'String accountId = (String) session.getInputParams().get("accountId");'})]})}function p(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(u,{...e})}):u(e)}}}]);