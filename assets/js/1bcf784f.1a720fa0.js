"use strict";(globalThis.webpackChunkconvengine_docs=globalThis.webpackChunkconvengine_docs||[]).push([[5138],{486(e,s,n){n.r(s),n.d(s,{assets:()=>a,contentTitle:()=>d,default:()=>u,frontMatter:()=>r,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"deep-dive/rules-responses","title":"Rules & Responses","description":"Rule types currently implemented","source":"@site/docs/v1/deep-dive/rules-responses.mdx","sourceDirName":"deep-dive","slug":"/deep-dive/rules-responses","permalink":"/docs/v1/deep-dive/rules-responses","draft":false,"unlisted":false,"editUrl":"https://github.com/salilvnair/convengine-docs/tree/main/docs/v1/deep-dive/rules-responses.mdx","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"title":"Rules & Responses","sidebar_position":6,"hide_table_of_contents":true},"sidebar":"docSidebar","previous":{"title":"Intent & Schema","permalink":"/docs/v1/deep-dive/intent-and-schema"},"next":{"title":"MCP & Audit","permalink":"/docs/v1/deep-dive/mcp-audit"}}');var i=n(4848),l=n(8453),o=n(9131);const r={title:"Rules & Responses",sidebar_position:6,hide_table_of_contents:!0},d="Rules and Response Resolution",a={},c=[{value:"Rule types currently implemented",id:"rule-types-currently-implemented",level:2},{value:"Rule actions in detail",id:"rule-actions-in-detail",level:2},{value:"Response selection algorithm",id:"response-selection-algorithm",level:2},{value:"EXACT vs DERIVED",id:"exact-vs-derived",level:2}];function p(e){const s={admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",ul:"ul",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.header,{children:(0,i.jsx)(s.h1,{id:"rules-and-response-resolution",children:"Rules and Response Resolution"})}),"\n",(0,i.jsx)(s.h2,{id:"rule-types-currently-implemented",children:"Rule types currently implemented"}),"\n",(0,i.jsx)(o.p,{title:"Rule type resolver coverage",columns:["rule_type","Resolver","When to use"],rows:[["EXACT","ExactRuleTypeResolver","Exact text-driven trigger"],["REGEX","RegexRuleTypeResolver","Pattern-driven trigger"],["JSON_PATH","JsonPathRuleTypeResolver","Condition over session/context/payload facts"]]}),"\n",(0,i.jsx)(s.h2,{id:"rule-actions-in-detail",children:"Rule actions in detail"}),"\n",(0,i.jsx)(o.p,{title:"Action behavior",columns:["action","What it changes","Typical real-world use"],rows:[["SET_STATE","session.state","Move flow to AWAITING_ACCOUNT_ID"],["SET_INTENT","session.intent","Reclassify after deterministic signal"],["SET_JSON","input param from JSON path extract","Pull ticketId/correlationId from context"],["GET_CONTEXT","input param snapshot of context","Use context in downstream prompts/tasks"],["GET_SESSION","input param snapshot of session facts","Expose runtime flags to prompts"],["GET_SCHEMA_JSON","input param schema-only field subset","Use only extracted form fields"],["SET_TASK","executes custom task bean methods","Raise incident, call internal orchestrator"]]}),"\n",(0,i.jsx)(s.h2,{id:"response-selection-algorithm",children:"Response selection algorithm"}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsxs)(s.li,{children:["Find enabled ",(0,i.jsx)(s.code,{children:"ce_response"})," candidates matching intent/state"]}),"\n",(0,i.jsx)(s.li,{children:"Score by exact state/intent > ANY/null fallback > priority"}),"\n",(0,i.jsx)(s.li,{children:"Choose top candidate"}),"\n",(0,i.jsx)(s.li,{children:"Resolve by response type"}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"exact-vs-derived",children:"EXACT vs DERIVED"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"EXACT"}),": deterministic payload (",(0,i.jsx)(s.code,{children:"exact_text"}),")"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"DERIVED"}),": template-rendered + LLM-generated output"]}),"\n"]}),"\n",(0,i.jsx)(o.vl,{title:"Derived response path (concept)",language:"text",children:"ce_response(response_type=DERIVED, output_format=TEXT)\n -> template from ce_prompt_template(response_type=TEXT)\n -> render variables\n -> llm.generateText(...)\n -> optional ResponseTransformer\n -> persisted assistant output"}),"\n",(0,i.jsx)(s.admonition,{title:"Intervention points",type:"tip",children:(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["Use ",(0,i.jsx)(s.code,{children:"ResponseTransformer"})," after response resolution to apply consumer-specific post-processing."]}),"\n",(0,i.jsxs)(s.li,{children:["Use hook on ",(0,i.jsx)(s.code,{children:"RulesStep"})," to inspect rule cascades in production debugging."]}),"\n"]})}),"\n",(0,i.jsx)(o.f4,{type:"warning",title:"Enum drift warning",children:(0,i.jsxs)(s.p,{children:["Do not insert unimplemented rule types/actions in DB. Keep ",(0,i.jsx)(s.code,{children:"ce_rule"})," values aligned with installed resolver classes."]})})]})}function u(e={}){const{wrapper:s}={...(0,l.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(p,{...e})}):p(e)}}}]);