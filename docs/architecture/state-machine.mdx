import { FlowStep, Decision, Highlight, Conversation, User, Engine, Assistant } from "../../src/components/convengine";

# ğŸ” State Machine

ConvEngine treats every conversation as a **finite state machine (FSM)**.
A state represents *where the conversation currently is* â€”  
not what the user typed last.

---

## ğŸ§­ Core Conversation States

<FlowStep step="1" title="Start / Idle">
  The conversation has been created but no actionable intent
  has been confidently identified yet.
</FlowStep>

<FlowStep step="2" title="Waiting for Required Information">
  The intent is known, but the required JSON schema is incomplete.
  The engine must ask focused follow-up questions.
</FlowStep>

<FlowStep step="3" title="Ready for Confirmation or Execution">
  All required schema fields are present and validated.
  The request can now be confirmed or executed.
</FlowStep>

<FlowStep step="4" title="Completed">
  The requested action has been successfully completed
  and the conversation can safely end.
</FlowStep>

---

## ğŸ§® How State Transitions Work

State transitions are driven entirely by **rules and schema completeness**.

<Decision type="deterministic">
  A state changes only when:
  <ul>
    <li>a rule explicitly sets a new state, or</li>
    <li>schema completeness allows auto-advancement</li>
  </ul>
</Decision>

LLMs never decide *when* a state changes â€”  
they only assist *after* the decision is made.

---

## ğŸ§  Example: Multiâ€‘Turn State Transition

### â¤ Turn 1

<Conversation>
  <User>move from A</User>
  <Assistant>
    Where do you want to move the service?
  </Assistant>
</Conversation>

---

### â¤ Turn 2

<Conversation>
  <User>to B</User>
  <Assistant>
    Please confirm that you want to move the service from A to B.
  </Assistant>
</Conversation>

---

## ğŸš« What LLMs Are Not Allowed To Do

<Highlight type="danger">
  LLMs are never allowed to:
  <ul>
    <li>change conversation state</li>
    <li>infer missing required fields</li>
    <li>skip validation rules</li>
  </ul>
</Highlight>

---

## âœ… Why This Design Matters

- ğŸ”’ Predictable and safe state transitions  
- ğŸ§ª Easy debugging and replayability  
- ğŸ—ï¸ Workflowâ€‘like behavior with conversational UX  

ConvEngine behaves like a **workflow engine at its core**,  
but communicates like a **human assistant at the edges**.
