"use strict";(globalThis.webpackChunkconvengine_docs=globalThis.webpackChunkconvengine_docs||[]).push([[247],{3502(e,t,n){n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>s,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"deep-dive/improvement-backlog","title":"Improvement Backlog","description":"This page turns the correctness and scalability recommendations into implementation-ready work items. Use it as the execution plan after reading Data Correctness Gotchas.","source":"@site/docs/v1/deep-dive/improvement-backlog.mdx","sourceDirName":"deep-dive","slug":"/deep-dive/improvement-backlog","permalink":"/docs/v1/deep-dive/improvement-backlog","draft":false,"unlisted":false,"editUrl":"https://github.com/salilvnair/convengine-docs/tree/main/docs/v1/deep-dive/improvement-backlog.mdx","tags":[],"version":"current","sidebarPosition":9,"frontMatter":{"title":"Improvement Backlog","sidebar_position":9,"hide_table_of_contents":true},"sidebar":"docSidebar","previous":{"title":"Data Correctness Gotchas","permalink":"/docs/v1/deep-dive/failure-gotchas"},"next":{"title":"Version History","permalink":"/docs/v1/version-history"}}');var r=n(4848),o=n(8453),a=n(9131);const s={title:"Improvement Backlog",sidebar_position:9,hide_table_of_contents:!0},c="Improvement Backlog",l={},d=[{value:"Phase 1: Correctness-critical tickets",id:"phase-1-correctness-critical-tickets",level:2},{value:"Phase 2: Operability and convenience tickets",id:"phase-2-operability-and-convenience-tickets",level:2},{value:"Phase 3: Scalability tickets",id:"phase-3-scalability-tickets",level:2},{value:"Recommended rollout order",id:"recommended-rollout-order",level:2},{value:"Done criteria for the program",id:"done-criteria-for-the-program",level:2}];function p(e){const t={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"improvement-backlog",children:"Improvement Backlog"})}),"\n",(0,r.jsxs)(t.p,{children:["This page turns the correctness and scalability recommendations into implementation-ready work items. Use it as the execution plan after reading ",(0,r.jsx)(t.code,{children:"Data Correctness Gotchas"}),"."]}),"\n",(0,r.jsx)(t.h2,{id:"phase-1-correctness-critical-tickets",children:"Phase 1: Correctness-critical tickets"}),"\n",(0,r.jsx)(a.p,{title:"P0/P1 backlog",columns:["Ticket","Problem","Implementation","Acceptance criteria","Effort"],rows:[["CE-001: State transition guard","Model output can force invalid `intent/state` jumps.","Add transition validator before final persistence; block or quarantine disallowed transitions.","Invalid transitions never persist; blocked transitions produce explicit error stage and fallback response.","M"],["CE-002: Conversation optimistic locking","Concurrent same-conversation writes produce last-write-wins corruption.","Add `version` column and optimistic lock handling on conversation updates.","Conflicting parallel updates produce deterministic conflict behavior (retry or fail with known code).","M"],["CE-003: LLM context lifecycle safety","ThreadLocal LLM context can leak across pooled threads if not cleared.","Wrap every `LlmInvocationContext.set(...)` in `try/finally` + `clear()`.","No stale context observed under stress test with mixed conversation IDs.","S"],["CE-004: Prompt variable allowlist","All input params are currently exposable to prompt rendering.","Introduce allowlist + redaction for sensitive/unexpected keys.","Only approved prompt keys appear in rendered prompt payloads.","M"],["CE-005: Stale context eviction rules","Partial schema merges can keep incompatible old fields.","Add per-intent/state field-retention policy and evict on transitions.","Transition tests show old incompatible fields are removed deterministically.","M"]]}),"\n",(0,r.jsx)(t.h2,{id:"phase-2-operability-and-convenience-tickets",children:"Phase 2: Operability and convenience tickets"}),"\n",(0,r.jsx)(a.p,{title:"Developer and operator UX",columns:["Ticket","Problem","Implementation","Acceptance criteria","Effort"],rows:[["CE-006: Config lint and dry-run","Broken rules/prompts are discovered too late.","Add validator command/endpoint for response mapping coverage, unresolved vars, rule loops, MCP safety checks.","Invalid config sets fail lint in CI and are blocked from promotion.","M"],["CE-007: Deterministic replay tool","Wrong-output incidents are hard to reproduce.","Replay conversation turns against frozen config snapshot and compare expected vs actual transitions.","At least one production incident can be replayed locally with identical state progression.","M-L"],["CE-008: Scenario test harness","Manual QA misses edge-path regressions.","Add fixture-driven conversation tests (turn sequence + expected intent/state/output assertions).","Regression suite catches known sticky-intent, rule-collision, and reset-flow bugs.","M"],["CE-009: Transition map generator","State machine behavior is opaque to integrators.","Generate graph from rules/responses/schema transitions with dead-end warnings.","Docs include generated transition map and dead-end detection report.","S-M"]]}),"\n",(0,r.jsx)(t.h2,{id:"phase-3-scalability-tickets",children:"Phase 3: Scalability tickets"}),"\n",(0,r.jsx)(a.p,{title:"Throughput and horizontal scale",columns:["Ticket","Problem","Implementation","Acceptance criteria","Effort"],rows:[["CE-010: Hot-path query refactor","`findAll().stream()` in request path degrades with config size.","Replace with indexed query methods for response/template/schema selection.","P95 latency remains stable when control-plane rows scale 10x.","M"],["CE-011: Config cache with version invalidation","Repeated config reads increase latency variability.","Add cache per intent/state with invalidation on config mutation.","Cache hit ratio > 90% in steady state without stale-config incidents.","M-L"],["CE-012: Per-conversation execution serialization","Concurrent turns create races as scale increases.","Route requests by conversation key to single active worker/partition.","No race-induced state drift in concurrency stress tests.","L"],["CE-013: Canonical turn store","History reconstructed from audit can be incomplete/noisy.","Persist normalized user/assistant turns and switch history provider to it.","History quality checks pass even when audit levels change.","M-L"],["CE-014: Bounded enrichment budgets","Optional enrichments can inflate synchronous latency.","Apply strict timeout budget for container/MCP enrichments and degrade gracefully.","SLO maintained under downstream slowdown with deterministic fallback behavior.","M"]]}),"\n",(0,r.jsx)(t.h2,{id:"recommended-rollout-order",children:"Recommended rollout order"}),"\n",(0,r.jsxs)(t.ol,{children:["\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.code,{children:"CE-003"})," and ",(0,r.jsx)(t.code,{children:"CE-001"})," first (cheap/high impact correctness guards)."]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.code,{children:"CE-002"})," before any high-concurrency scale work."]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.code,{children:"CE-004"})," and ",(0,r.jsx)(t.code,{children:"CE-005"})," before prompt/template expansion."]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.code,{children:"CE-006"})," + ",(0,r.jsx)(t.code,{children:"CE-008"})," to stop regressions while refactoring."]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.code,{children:"CE-010"})," and ",(0,r.jsx)(t.code,{children:"CE-011"})," to stabilize throughput."]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.code,{children:"CE-012"})," for horizontal scale and race elimination."]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.code,{children:"CE-013"})," and ",(0,r.jsx)(t.code,{children:"CE-014"})," for long-term quality and latency control."]}),"\n"]}),"\n",(0,r.jsx)(t.h2,{id:"done-criteria-for-the-program",children:"Done criteria for the program"}),"\n",(0,r.jsx)(a.p,{title:"Exit gates",columns:["Gate","Target"],rows:[["Correctness","No illegal transition persistence in test suite + canary runtime."],["Concurrency","No race-induced state drift under parallel same-conversation load tests."],["Security","Prompt exposure allowlist and MCP safety policy enforcement enabled by default."],["Scalability","Stable p95/p99 under 10x config growth and peak expected QPS."],["Operability","Config lint, replay, and scenario tests integrated into release workflow."]]}),"\n",(0,r.jsx)(a.f4,{type:"success",title:"How to use this backlog",children:(0,r.jsx)(t.p,{children:"Treat each ticket as a tracked ADR-backed change. For every ticket: define owner, rollout guardrails, migration/rollback plan, and evidence artifact (test report or benchmark)."})})]})}function h(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(p,{...e})}):p(e)}}}]);